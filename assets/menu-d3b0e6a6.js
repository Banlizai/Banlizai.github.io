import{u as e,Y as a,b as s,U as t,Z as o,r,$ as i,w as n,a0 as l,a1 as c,a2 as d,f as m,h as u,i as p,j as f,k as y,l as j,m as b,M as h}from"./index-0ca45986.js";import{M as v,n as g,B as k,ao as _,Y as w}from"./@arco-design-8dabd30f.js";import{a as C,b as I,c as x,e as T}from"./columns-1685844f.js";import{d as D,u as L,h as F,l as O,a_ as S,o as U,c as q,f as z,s as E,w as R,N as V,m as B,C as M,a1 as Y,Y as A,q as K,F as N,r as P}from"./@vue-2b41ce19.js";import{a as $}from"./@vueuse-ca9a384d.js";import"./pinia-b3c1485e.js";import"./axios-6371c10e.js";import"./@logicflow-85f8458e.js";import"./ids-ef071351.js";import"./lodash-es-1e3e3aa2.js";import"./preact-5fc9b0bf.js";import"./qs-f981fe00.js";import"./side-channel-01aeb4d9.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-fae29077.js";import"./object-inspect-0eda087e.js";import"./dayjs-094145ee.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-70e2faff.js";import"./tiny-emitter-35dc7566.js";import"./echarts-24943dbb.js";import"./zrender-2d3b2bba.js";import"./tslib-a4e99503.js";import"./xgplayer-700bd6a3.js";import"./delegate-ef66b241.js";import"./downloadjs-91c0ea73.js";import"./quill-ecb3881d.js";import"./sortablejs-2f5483e3.js";import"./b-tween-5055d79e.js";import"./b-validate-457088db.js";import"./resize-observer-polyfill-ad543aa3.js";import"./scroll-into-view-if-needed-59a60a09.js";import"./compute-scroll-into-view-2962e95c.js";import"./number-precision-d9b928a1.js";import"./dict-9c237ae6.js";const H={class:"main-container"},J=D({__name:"menu",setup(D){const{ADD:J,UPDATE:Z}=h,G=e(),Q=L(null),W=C(le),X=I(),{bordered:ee,striped:ae,handleSuccess:se,tableLoading:te,dataList:oe}=X,re=T("menuId"),{menu:ie}=x(),ne=ie;async function le(){te.value=!0;try{const{code:e,data:o,msg:r}=await a({pageNum:W.page,pageSize:W.pageSize,...s(ne)}),i={code:e,msg:r,data:t(o,0,"menuId")};te.value=!1,se(P(i))}catch(e){}}function ce(){ne.forEach((e=>{e.searchReset?e.searchReset():e.searchValue=void 0})),le()}async function de(){try{const{data:e}=await o(s(ne));ne.find((a=>{"parentId"!==a.key||(a.optionItems=r(e,"id","label"))}))}catch(e){}}function me(){var e;G.title=J,G.itemOption=ne,null==(e=Q.value)||e.show()}const ue=async()=>{var e;try{const a=G.itemOption.find((e=>"menuId"===e.key)),s=n(G.itemOption),{msg:t}=(null==a?void 0:a.value)?await l(s):await c(s);v.success(t),null==(e=Q.value)||e.close(),le(),de()}catch(a){}},pe=$((async({record:e})=>{try{const{data:a}=await d(e.menuId);ne.forEach((e=>{e.value=a[e.key],"parentId"===e.key&&(e.value=a.parentId)}))}catch(a){}}),300);return F((()=>{de(),le()})),(e,a)=>{const s=O("icon-plus"),t=k,o=m,r=u,n=p,l=_,c=w,d=f,h=y,C=j,I=b,x=S("hasPerm");return U(),q(N,null,[z("div",H,[E(C,{ref:"tableBody"},{header:R((()=>[E(n,{"show-filter":!0,title:"",onSearch:le,onResetSearch:ce},{"more-button-content":R((()=>[V((U(),B(t,{type:"primary",onClick:me},{icon:R((()=>[E(s)])),default:R((()=>[M(" 添加 ")])),_:1})),[[x,["system:menu:add"]]])])),"search-content":R((()=>[E(o,{modelValue:Y(ne),"onUpdate:modelValue":a[0]||(a[0]=e=>A(ne)?ne.value=e:null)},null,8,["modelValue"])])),"table-config":R((()=>[E(r,{tableColumns:Y(ne),"onUpdate:border":a[1]||(a[1]=e=>Y(X).bordered.value=e),"onUpdate:striped":a[2]||(a[2]=e=>Y(X).striped.value=e),onDoRefresh:le},null,8,["tableColumns"])])),_:1})])),default:R((()=>[E(d,{bordered:Y(ee),striped:Y(ae),tableLoading:Y(te),dataList:Y(oe),tableColumns:Y(ne),rowKey:Y(re)},{optional:R((({record:e})=>[E(l,{type:"primary"},{default:R((()=>[V((U(),B(t,{onClick:a=>(async e=>{var a;G.title=Z,G.itemOption=ne,null==(a=Q.value)||a.show(),await pe({record:e})})(e)},{default:R((()=>[M(" 编辑 ")])),_:2},1032,["onClick"])),[[x,["system:menu:add"]]]),V((U(),B(t,{onClick:a=>(e=>{const a=e.menuId;e?g.confirm({title:"提示",content:`确定要${e?"删除此":"删除所选择的"}数据吗？`,cancelText:"取消",okText:"删除",onOk:async()=>{try{const{msg:e}=await i(a);v.success(e),le()}catch(e){}}}):v.error("请选择要删除的数据")})(e)},{default:R((()=>[M(" 删除 ")])),_:2},1032,["onClick"])),[[x,["system:menu:remove"]]])])),_:2},1024)])),menuType:R((({record:e})=>["M"===e.menuType?(U(),B(c,{key:0,color:"blue"},{default:R((()=>[M("目录")])),_:1})):"C"===e.menuType?(U(),B(c,{key:1,color:"green"},{default:R((()=>[M("菜单")])),_:1})):"F"===e.menuType?(U(),B(c,{key:2,color:"red"},{default:R((()=>[M("按钮")])),_:1})):K("",!0)])),isCache:R((({record:e})=>[e.isCache?(U(),B(c,{key:0,color:"green"},{default:R((()=>[M("是")])),_:1})):(U(),B(c,{key:1,color:"red"},{default:R((()=>[M("否")])),_:1}))])),isFrame:R((({record:e})=>[e.isFrame?(U(),B(c,{key:0,color:"green"},{default:R((()=>[M("是")])),_:1})):(U(),B(c,{key:1,color:"red"},{default:R((()=>[M("否")])),_:1}))])),status:R((({record:e})=>["0"===e.status?(U(),B(c,{key:0,color:"green"},{default:R((()=>[M("正常")])),_:1})):(U(),B(c,{key:1,color:"red"},{default:R((()=>[M("停用")])),_:1}))])),visible:R((({record:e})=>["0"===e.visible?(U(),B(c,{key:0,color:"green"},{default:R((()=>[M("显示")])),_:1})):(U(),B(c,{key:1,color:"red"},{default:R((()=>[M("隐藏")])),_:1}))])),_:1},8,["bordered","striped","tableLoading","dataList","tableColumns","rowKey"])])),footer:R((()=>[E(h,{pagination:Y(W)},null,8,["pagination"])])),_:1},512)]),E(I,{ref_key:"modalDialog",ref:Q,config:Y(G),onConfirm:ue},null,8,["config"])],64)}}});export{J as default};
