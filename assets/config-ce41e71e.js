import{g as e,A as a,p as s,G as t,u as o,a as i,b as r,e as n,T as l,w as c,f as d,h as m,i as p,j as u,k as f,l as y,m as g,M as j}from"./index-0ca45986.js";import{M as h,n as w,B as b,Y as v}from"./@arco-design-8dabd30f.js";import{a as C,b as k,u as S,c as _,d as x,e as A}from"./columns-1685844f.js";import{d as T,u as D,h as R,a_ as L,o as O,c as z,f as B,s as K,w as E,N as I,m as U,a1 as V,C as q,Y,D as $,F,r as M}from"./@vue-2b41ce19.js";import{a as N}from"./@vueuse-ca9a384d.js";import"./pinia-b3c1485e.js";import"./axios-6371c10e.js";import"./@logicflow-85f8458e.js";import"./ids-ef071351.js";import"./lodash-es-1e3e3aa2.js";import"./preact-5fc9b0bf.js";import"./qs-f981fe00.js";import"./side-channel-01aeb4d9.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-fae29077.js";import"./object-inspect-0eda087e.js";import"./dayjs-094145ee.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-70e2faff.js";import"./tiny-emitter-35dc7566.js";import"./echarts-24943dbb.js";import"./zrender-2d3b2bba.js";import"./tslib-a4e99503.js";import"./xgplayer-700bd6a3.js";import"./delegate-ef66b241.js";import"./downloadjs-91c0ea73.js";import"./quill-ecb3881d.js";import"./sortablejs-2f5483e3.js";import"./b-tween-5055d79e.js";import"./b-validate-457088db.js";import"./resize-observer-polyfill-ad543aa3.js";import"./scroll-into-view-if-needed-59a60a09.js";import"./compute-scroll-into-view-2962e95c.js";import"./number-precision-d9b928a1.js";import"./dict-9c237ae6.js";const P={class:"main-container"},G=T({__name:"config",setup(T){const{ADD:G,UPDATE:H}=j,J=o(),Q=D(null),W=C(pe),X=k(),{selectedRowKeys:Z,onSelectionChange:ee,showCheckedAll:ae}=S(),{bordered:se,striped:te,handleSuccess:oe,tableLoading:ie,dataList:re}=X,ne=A("configId"),{config:le}=_(),ce=le,{onSorterChange:de,sortOrder:me}=x(pe);async function pe(){ie.value=!0;try{const{code:a,rows:s,msg:t,total:o}=await(async a=>await e({url:"/system/config/list",data:a}))({pageNum:W.page,pageSize:W.pageSize,orderByColumn:me.orderBy,isAsc:me.isAsc,...r(ce)}),i={code:a,msg:t,data:s};ie.value=!1,oe(M(i)),W.setTotalSize(o||10)}catch(a){}}function ue(){pe()}function fe(){ce.forEach((e=>{e.searchReset?e.searchReset():e.searchValue.value=void 0})),ue()}D(!1);const ye=e=>{const a=e.configId||Z.value.toString();a?w.confirm({title:"提示",content:`确定要${e?"删除此":"删除所选择的"}数据吗？`,cancelText:"取消",okText:"删除",onOk:async()=>{try{const{msg:e}=await(async e=>await t({url:`/system/config/${e}`,data:e}))(a);h.success(e),pe()}catch(e){}}}):h.error("请选择要删除的数据")},ge=async()=>{try{n(l,r(ce),"参数管理")}catch(e){}};function je(){var e;J.title=G,J.itemOption=ce,null==(e=Q.value)||e.show()}const he=async()=>{var e;try{const t=J.itemOption.find((e=>"configId"===e.key)),o=c(J.itemOption),{msg:i}=(null==t?void 0:t.value)?await(async e=>await s({url:"/system/config",data:e}))(o):await(async e=>await a({url:"/system/config",data:e}))(o);h.success(i),null==(e=Q.value)||e.close(),pe()}catch(t){}},we=N((async({record:a})=>{try{const{data:s}=await(async a=>await e({url:`/system/config/${a}`,data:a}))(a.configId);ce.forEach((e=>{e.value=s[e.key]}))}catch(s){}}),300);return R(pe),(e,a)=>{const s=b,t=d,o=m,r=p,n=v,l=u,c=f,j=y,h=g,w=L("hasPerm");return O(),z(F,null,[B("div",P,[K(j,{ref:"tableBody"},{header:E((()=>[K(r,{"show-filter":!0,title:"",onSearch:ue,onResetSearch:fe},{"more-button-content":E((()=>[I((O(),U(s,{type:"primary",loading:V(i),onClick:ge},{default:E((()=>[q(" 导出参数 ")])),_:1},8,["loading"])),[[w,["system:dict:export"]]]),I((O(),U(s,{type:"primary",onClick:je},{default:E((()=>[q(" 添加 ")])),_:1})),[[w,["system:dict:add"]]]),I((O(),U(s,{status:"danger",onClick:ye},{default:E((()=>[q("删除")])),_:1})),[[w,["system:dict:remove"]]])])),"search-content":E((()=>[K(t,{modelValue:V(ce),"onUpdate:modelValue":a[0]||(a[0]=e=>Y(ce)?ce.value=e:null)},null,8,["modelValue"])])),"table-config":E((()=>[K(o,{tableColumns:V(ce),"onUpdate:border":a[1]||(a[1]=e=>V(X).bordered.value=e),"onUpdate:striped":a[2]||(a[2]=e=>V(X).striped.value=e),onDoRefresh:pe},null,8,["tableColumns"])])),_:1})])),default:E((()=>[K(l,{bordered:V(se),striped:V(te),tableLoading:V(ie),dataList:V(re),tableColumns:V(ce),rowKey:V(ne),onSelectionChange:V(ee),selectedRowKeys:V(Z),showCheckedAll:V(ae),onSorterChange:V(de)},{optional:E((({record:e})=>[I((O(),U(s,{type:"primary",onClick:a=>(async e=>{var a;J.title=H,J.itemOption=ce,null==(a=Q.value)||a.show(),await we({record:e})})(e)},{default:E((()=>[q("编辑")])),_:2},1032,["onClick"])),[[w,["system:dict:edit"]]]),I((O(),U(s,{status:"danger",onClick:a=>ye(e)},{default:E((()=>[q("删除")])),_:2},1032,["onClick"])),[[w,["system:dict:remove"]]])])),configType:E((({record:e})=>[K(n,{color:"Y"===e.configType?"red":"green"},{default:E((()=>[q($(0===e.configType?"是":"否"),1)])),_:2},1032,["color"])])),_:1},8,["bordered","striped","tableLoading","dataList","tableColumns","rowKey","onSelectionChange","selectedRowKeys","showCheckedAll","onSorterChange"])])),footer:E((()=>[K(c,{pagination:V(W)},null,8,["pagination"])])),_:1},512)]),K(h,{ref_key:"modalDialog",ref:Q,config:V(J),onConfirm:he},null,8,["config"])],64)}}});export{G as default};
