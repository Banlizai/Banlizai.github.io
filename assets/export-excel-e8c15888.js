import{p as T}from"./http-79937b7b.js";import{g as B,_ as I}from"./index-09e9d0bf.js";import{b as E,c as L}from"./table-d5bdf2e1.js";import{X as p}from"./xlsx-09ff2a58.js";import{e as w,r as S,o as v,j as a,k as r,p as b,v as m,m as e,y as l,F,R as $,l as c,G as N,z as y}from"./@vue-0366cb61.js";import"./@arco-design-f5decd74.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./compute-scroll-into-view-183f845a.js";import"./b-tween-aacd5abe.js";import"./dayjs-bf5be20d.js";import"./@logicflow-5cdfeb8e.js";import"./ids-46106237.js";import"./preact-b8060ab3.js";import"./b-validate-48f29bf6.js";import"./number-precision-7e656275.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./path-browserify-188d1ff8.js";import"./vue-router-5bfb708a.js";import"./axios-0bf28a1e.js";import"./qs-b99d1803.js";import"./side-channel-5f245a46.js";import"./get-intrinsic-b9397c9a.js";import"./has-symbols-e8f3ca0e.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-9ceb8f5b.js";import"./object-inspect-8530d459.js";import"./pinia-16e4d8ec.js";import"./@vueuse-945dd224.js";import"./mockjs-417a16d8.js";import"./tiny-emitter-6d407e5e.js";import"./xgplayer-cee6bcaa.js";import"./quill-9354d83a.js";import"./sortablejs-be94e56d.js";import"./lodash-es-734afc83.js";const R=w({name:"ExportExcel",setup(){const t=S(null),s=E(),d=L([s.indexColumn,{title:"名称",key:"nickName",dataIndex:"nickName"},{title:"性别",key:"gender",dataIndex:"gender"},{title:"地址",key:"address",dataIndex:"address"},{title:"登录时间",key:"lastLoginTime",dataIndex:"lastLoginTime"},{title:"登录IP",key:"lastLoginIp",dataIndex:"lastLoginIp"},{title:"状态",key:"status",dataIndex:"status"}]);function u(){T({url:B,data:{page:1,pageSize:20}}).then(s.handleSuccess).catch(console.log)}function _(){const f=p.utils.table_to_sheet(t.value.$el),i=p.utils.book_new();p.utils.book_append_sheet(i,f,"数据报表"),p.writeFile(i,"tale-list.xlsx")}return v(u),{tableRef:t,tableColumns:d,...s,exportExcel:_}}}),X={class:"main-container"};function z(t,s,d,u,_,f){const i=a("a-button"),x=a("TableHeader"),k=a("a-tag"),g=a("a-table-column"),h=a("a-table"),C=a("TableBody");return r(),b("div",X,[m(x,{"show-filter":!1},{"table-config":e(()=>[m(i,{type:"primary",onClick:t.exportExcel},{default:e(()=>[l("导出Excel ")]),_:1},8,["onClick"])]),_:1}),m(C,{ref:"tableBody"},{default:e(()=>[m(h,{ref:"tableRef",data:t.dataList,pagination:!1},{columns:e(()=>[(r(!0),b(F,null,$(t.tableColumns,o=>(r(),c(g,{key:o.key,align:"center",title:o.title,"data-index":o.key},N({_:2},[o.key==="index"?{name:"cell",fn:e(({rowIndex:n})=>[l(y(n+1),1)]),key:"0"}:o.key==="gender"?{name:"cell",fn:e(({record:n})=>[l(y(n.gender===1?"男":"女"),1)]),key:"1"}:o.key==="status"?{name:"cell",fn:e(({record:n})=>[n.status===1?(r(),c(k,{key:0,color:"blue"},{default:e(()=>[l("正常")]),_:1})):(r(),c(k,{key:1,color:"red"},{default:e(()=>[l("禁用")]),_:1}))]),key:"2"}:void 0]),1032,["title","data-index"]))),128))]),_:1},8,["data"])]),_:1},512)])}const ye=I(R,[["render",z]]);export{ye as default};
