import{M as e,c as a,A as l,f as t,a9 as o,Z as n,_ as i,Q as r,am as s,X as d,Y as u,al as c}from"./@arco-design-306c64c5.js";import{K as m,_ as p,p as f,e as y,k as v,m as k}from"./index-4d88e5a9.js";import{p as h}from"./http-5a7406c8.js";import{b as j,c as g,d as x}from"./table-76ae527c.js";import{e as _,r as C,o as b,C as w,k as I,p as D,v as E,m as R,F as K,R as O,l as L,G as U,y as q,z as A,n as V,u as M,s as F}from"./@vue-ab7141bd.js";import"./resize-observer-polyfill-ad543aa3.js";import"./compute-scroll-into-view-2962e95c.js";import"./b-tween-5055d79e.js";import"./dayjs-f47c42f6.js";import"./@logicflow-435513e4.js";import"./ids-ef071351.js";import"./preact-173f4f0b.js";import"./b-validate-42052d35.js";import"./number-precision-d9b928a1.js";import"./scroll-into-view-if-needed-59a60a09.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-74931cc0.js";import"./pinia-c1bb2998.js";import"./@vueuse-96027ebb.js";import"./axios-7fb8d0b2.js";import"./qs-536c1183.js";import"./side-channel-52a2f2e5.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-d34af9d2.js";import"./object-inspect-a85657d3.js";import"./mockjs-a6500710.js";import"./tiny-emitter-af47831f.js";import"./xgplayer-474fd437.js";import"./quill-daa56216.js";import"./sortablejs-2f5483e3.js";import"./lodash-es-6e445b1b.js";const T="ROLE_",S=[{label:"角色名称",type:"input",key:"name",value:C(""),required:!0,placeholder:"请输入角色名称",validator:function(){return!!this.value.value||(e.error(this.placeholder||""),!1)}},{label:"角色编号",key:"roleCode",value:C(""),type:"input",required:!0,placeholder:"请输入角色编号",validator:function(){return!!this.value.value||(e.error(this.placeholder||""),!1)}},{label:"角色描述",key:"description",value:C(""),type:"textarea",placeholder:"请输入角色描述"}];function z(e,a,l){const t=[];return e.forEach((e=>{const o={};o.key=e.menuUrl,o.title=e.menuName,a.push(o.key),e.children&&(l.push(o.key),o.children=z(e.children,a,l)),t.push(o)})),t}const G=_({name:"Role",setup(){const l=C(null),t=C(null),o=j(),n=x("id"),i=C("添加角色"),r=C([]),s=g([o.indexColumn,{title:"角色名称",key:"name",dataIndex:"name"},{title:"角色编号",key:"roleCode",dataIndex:"roleCode"},{title:"角色描述",key:"description",dataIndex:"description"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"actions",dataIndex:"actions"}]),d=C([]),u=C([]),c=C({});return b((async function(){o.handleSuccess({code:200,data:[{id:1,name:"超级管理员",roleCode:"ROLE_admin",description:"超级管理员"},{id:2,name:"编辑员",roleCode:"ROLE_editor",description:"编辑员"}],msg:"获取数据成功"})})),{ROLE_CODE_FLAG:T,modalDialogRef:l,menuModalDialogRef:t,rowKey:n,formModel:c,menuData:r,tableColumns:s,formItems:S,actionTitle:i,defaultCheckedKeys:d,defaultExpandedKeys:u,...o,onAddItem:function(){var e;i.value="添加角色",null==(e=l.value)||e.toggle(),S.forEach((e=>{e.reset?e.reset():e.value.value=""}))},onDataFormConfirm:function(){var a;S.every((e=>!e.validator||e.validator()))&&(null==(a=l.value)||a.toggle(),e.success("模拟菜单添加成功，参数为："+JSON.stringify(S.reduce(((e,a)=>(e[a.key]=a.value.value,e)),{}))))},onShowMenu:function(e){h({url:m,data:{roleId:e.id}}).then((e=>{var a;r.value=[],d.value=[],u.value=[],r.value=z(e.data,d.value,u.value),null==(a=t.value)||a.toggle()})).catch(console.log)},onDeleteItem:function(l){a.confirm({title:"提示",content:"是否要删除此角色？",cancelText:"取消",okText:"删除",onOk:()=>{e.success("模拟角色删除成功，参数为"+JSON.stringify(l))}})},onUpdateItem:function(e){var a;i.value="编辑角色",null==(a=l.value)||a.toggle(),w((()=>{S.forEach((a=>{const l=a.key,t=e[l];t&&("roleCode"===a.key?a.value.value=t.replace(T,""):a.value.value=t)}))}))}}}}),N={class:"main-container"};const J=p(G,[["render",function(e,a,m,p,h,j){const g=f,x=y,_=l,C=t,b=o,w=n,T=i,S=v,z=r,G=s,J=d,B=u,H=k,Q=c;return I(),D("div",N,[E(S,null,{header:R((()=>[E(x,{"show-filter":!1},{"table-config":R((()=>[E(g,{onAdd:e.onAddItem},null,8,["onAdd"])])),_:1})])),default:R((()=>[E(T,{bordered:!1,loading:e.tableLoading,data:e.dataList,pagination:!1,"row-key":e.rowKey},{columns:R((()=>[(I(!0),D(K,null,O(e.tableColumns,(a=>(I(),L(w,{key:a.key,align:a.align,title:a.title,width:a.width,"data-index":a.key,fixed:a.fixed},U({_:2},["index"===a.key?{name:"cell",fn:R((({rowIndex:e})=>[q(A(e+1),1)])),key:"0"}:"gender"===a.key?{name:"cell",fn:R((({record:e})=>[q(A(1===e.gender?"男":"女"),1)])),key:"1"}:"avatar"===a.key?{name:"cell",fn:R((({record:e})=>[E(_,null,{default:R((()=>[V("img",{src:e.avatar},null,8,["src"])])),_:2},1024)])),key:"2"}:"actions"===a.key?{name:"cell",fn:R((({record:a})=>[E(b,null,{default:R((()=>[E(C,{status:"success",onClick:l=>e.onUpdateItem(a)},{default:R((()=>[q("编辑")])),_:2},1032,["onClick"]),E(C,{status:"danger",onClick:l=>e.onDeleteItem(a)},{default:R((()=>[q("删除")])),_:2},1032,["onClick"]),E(C,{status:"warning",onClick:l=>e.onShowMenu(a)},{default:R((()=>[q(" 菜单权限 ")])),_:2},1032,["onClick"])])),_:2},1024)])),key:"3"}:void 0]),1032,["align","title","width","data-index","fixed"])))),128))])),_:1},8,["loading","data","row-key"])])),_:1}),E(H,{ref:"modalDialogRef",title:e.actionTitle,onConfirm:e.onDataFormConfirm},{content:R((()=>[E(B,{model:e.formModel},{default:R((()=>[(I(!0),D(K,null,O(e.formItems,(a=>(I(),L(J,{class:M([a.required?"form-item__require":"form-item__no_require"]),label:a.label,key:a.key},{default:R((()=>["input"===a.type?(I(),L(z,{key:0,placeholder:a.placeholder,modelValue:a.value.value,"onUpdate:modelValue":e=>a.value.value=e},U({_:2},["roleCode"===a.key?{name:"prepend",fn:R((()=>[q(A(e.ROLE_CODE_FLAG),1)])),key:"0"}:void 0]),1032,["placeholder","modelValue","onUpdate:modelValue"])):F("",!0),"textarea"===a.type?(I(),L(G,{key:1,modelValue:a.value.value,"onUpdate:modelValue":e=>a.value.value=e,placeholder:a.placeholder,"auto-size":{minRows:3,maxRows:5}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):F("",!0)])),_:2},1032,["class","label"])))),128))])),_:1},8,["model"])])),_:1},8,["title","onConfirm"]),E(H,{ref:"menuModalDialogRef",title:"编辑菜单权限"},{content:R((()=>[E(Q,{data:e.menuData,checkable:"","expanded-keys":e.defaultExpandedKeys,"onUpdate:expandedKeys":a[0]||(a[0]=a=>e.defaultExpandedKeys=a),"checked-keys":e.defaultCheckedKeys,"onUpdate:checkedKeys":a[1]||(a[1]=a=>e.defaultCheckedKeys=a)},null,8,["data","expanded-keys","checked-keys"])])),_:1},512)])}]]);export{J as default};
