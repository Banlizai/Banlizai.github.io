import{N as e,Q as t,d as l,v as a,I as n,r,c as o,O as i,w as s,u as c,s as u,m as d,q as g}from"./index-21254b6f.js";import{c as f,d as p,n as v,t as m,F as b,l as h,B as y,b as k,J as x,C as w,K as C,L as S,I,m as V,E as B,A,M,f as L,N as P,O as j,p as E,P as T,G as q,q as $}from"./with-install-460172ae.js";import{a as z,u as D}from"./use-route-30d0c75e.js";import{I as F,B as O}from"./index-e4150b28.js";import{u as R}from"./use-expose-c9171c69.js";import{F as W}from"./constant-1f96826c.js";let H=0;function K(){const t=e(),{name:l="unknown"}=(null==t?void 0:t.type)||{};return`${l}-${++H}`}const N=Symbol(),G=()=>t(N,null),[J,Q]=f("cell"),U={tag:p("div"),icon:String,size:String,title:v,value:v,label:v,center:Boolean,isLink:Boolean,border:m,required:Boolean,iconPrefix:String,valueClass:b,labelClass:b,titleClass:b,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}};const X=k(l({name:J,props:h({},U,z),setup(e,{slots:t}){const l=D(),n=()=>{if(t.label||y(e.label))return a("div",{class:[Q("label"),e.labelClass]},[t.label?t.label():e.label])},r=()=>{var l;if(t.title||y(e.title)){const r=null==(l=t.title)?void 0:l.call(t);if(Array.isArray(r)&&0===r.length)return;return a("div",{class:[Q("title"),e.titleClass],style:e.titleStyle},[r||a("span",null,[e.title]),n()])}},o=()=>{const l=t.value||t.default;if(l||y(e.value))return a("div",{class:[Q("value"),e.valueClass]},[l?l():a("span",null,[e.value])])},i=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const t=e.arrowDirection&&"right"!==e.arrowDirection?`arrow-${e.arrowDirection}`:"arrow";return a(F,{name:t,class:Q("right-icon")},null)}};return()=>{var n;const{tag:s,size:c,center:u,border:d,isLink:g,required:f}=e,p=null!=(n=e.clickable)?n:g,v={center:u,required:f,clickable:p,borderless:!d};return c&&(v[c]=!!c),a(s,{class:Q(v),role:p?"button":void 0,tabindex:p?0:void 0,onClick:l},{default:()=>{var l;return[t.icon?t.icon():e.icon?a(F,{name:e.icon,class:Q("left-icon"),classPrefix:e.iconPrefix},null):void 0,r(),o(),i(),null==(l=t.extra)?void 0:l.call(t)]}})}}}));function Y(e){return Array.isArray(e)?!e.length:0!==e&&!e}function Z(e,t){const{message:l}=t;return S(l)?l(e,t):l||""}function _({target:e}){e.composing=!0}function ee({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function te(e){return[...e].length}function le(e,t){return[...e].slice(0,t).join("")}const[ae,ne]=f("field"),re={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:v,formatter:Function,clearIcon:p("clear"),modelValue:V(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:p("focus"),formatTrigger:p("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}};const oe=k(l({name:ae,props:h({},U,re,{rows:v,type:p("text"),rules:Array,autosize:[Boolean,Object],labelWidth:v,labelClass:b,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}}),emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:l}){const f=K(),p=n({status:"unvalidated",focused:!1,validateMessage:""}),v=r(),m=r(),b=r(),{parent:h}=B(W),k=()=>{var t;return String(null!=(t=e.modelValue)?t:"")},S=t=>y(e[t])?e[t]:h&&y(h.props[t])?h.props[t]:void 0,V=o((()=>{const t=S("readonly");if(e.clearable&&!t){const t=""!==k(),l="always"===e.clearTrigger||"focus"===e.clearTrigger&&p.focused;return t&&l}return!1})),q=o((()=>b.value&&l.input?b.value():e.modelValue)),$=e=>e.reduce(((e,t)=>e.then((()=>{if("failed"===p.status)return;let{value:e}=q;if(t.formatter&&(e=t.formatter(e,t)),!function(e,t){if(Y(e)){if(t.required)return!1;if(!1===t.validateEmpty)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}(e,t))return p.status="failed",void(p.validateMessage=Z(e,t));if(t.validator){if(Y(e)&&!1===t.validateEmpty)return;return function(e,t){return new Promise((l=>{const a=t.validator(e,t);C(a)?a.then(l):l(a)}))}(e,t).then((l=>{l&&"string"==typeof l?(p.status="failed",p.validateMessage=l):!1===l&&(p.status="failed",p.validateMessage=Z(e,t))}))}}))),Promise.resolve()),z=()=>{p.status="unvalidated",p.validateMessage=""},D=()=>t("endValidate",{status:p.status,message:p.validateMessage}),O=(l=e.rules)=>new Promise((a=>{z(),l?(t("startValidate"),$(l).then((()=>{"failed"===p.status?(a({name:e.name,message:p.validateMessage}),D()):(p.status="passed",a(),D())}))):a()})),H=t=>{if(h&&e.rules){const{validateTrigger:l}=h.props,a=P(l).includes(t),n=e.rules.filter((e=>e.trigger?P(e.trigger).includes(t):a));n.length&&O(n)}},N=(l,a="onChange")=>{const n=l;l=(t=>{var l;const{maxlength:a}=e;if(y(a)&&te(t)>+a){const e=k();if(e&&te(e)===+a)return e;const n=null==(l=v.value)?void 0:l.selectionEnd;if(p.focused&&n){const e=[...t],l=e.length-+a;return e.splice(n-l,l),e.join("")}return le(t,+a)}return t})(l);const r=te(n)-te(l);if("number"===e.type||"digit"===e.type){const t="number"===e.type;l=j(l,t,t)}let o=0;if(e.formatter&&a===e.formatTrigger){const{formatter:t,maxlength:a}=e;if(l=t(l),y(a)&&te(l)>+a&&(l=le(l,+a)),v.value&&p.focused){const{selectionEnd:e}=v.value,l=le(n,e);o=te(t(l))-te(l)}}if(v.value&&v.value.value!==l)if(p.focused){let{selectionStart:e,selectionEnd:t}=v.value;if(v.value.value=l,y(e)&&y(t)){const a=te(l);r?(e-=r,t-=r):o&&(e+=o,t+=o),v.value.setSelectionRange(Math.min(e,a),Math.min(t,a))}}else v.value.value=l;l!==e.modelValue&&t("update:modelValue",l)},G=e=>{e.target.composing||N(e.target.value)},J=()=>{var e;return null==(e=v.value)?void 0:e.blur()},Q=()=>{const t=v.value;"textarea"===e.type&&e.autosize&&t&&function(e,t){const l=x();e.style.height="auto";let a=e.scrollHeight;if(I(t)){const{maxHeight:e,minHeight:l}=t;void 0!==e&&(a=Math.min(a,e)),void 0!==l&&(a=Math.max(a,l))}a&&(e.style.height=`${a}px`,w(l))}(t,e.autosize)},U=e=>{p.focused=!0,t("focus",e),c(Q),S("readonly")&&J()},ae=e=>{p.focused=!1,N(k(),"onBlur"),t("blur",e),S("readonly")||(H("onBlur"),c(Q),T())},re=e=>t("clickInput",e),oe=e=>t("clickLeftIcon",e),ie=e=>t("clickRightIcon",e),se=o((()=>"boolean"==typeof e.error?e.error:!(!h||!h.props.showError||"failed"!==p.status)||void 0)),ce=o((()=>{const e=S("labelWidth"),t=S("labelAlign");if(e&&"top"!==t)return{width:A(e)}})),ue=l=>{if(13===l.keyCode){h&&h.props.submitOnEnter||"textarea"===e.type||E(l),"search"===e.type&&J()}t("keypress",l)},de=()=>e.id||`${f}-input`,ge=()=>{const t=ne("control",[S("inputAlign"),{error:se.value,custom:!!l.input,"min-height":"textarea"===e.type&&!e.autosize}]);if(l.input)return a("div",{class:t,onClick:re},[l.input()]);const n={id:de(),ref:v,name:e.name,rows:void 0!==e.rows?+e.rows:void 0,class:t,disabled:S("disabled"),readonly:S("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${f}-label`:void 0,onBlur:ae,onFocus:U,onInput:G,onClick:re,onChange:ee,onKeypress:ue,onCompositionend:ee,onCompositionstart:_};return"textarea"===e.type?a("textarea",n,null):a("input",d("number"===(r=e.type)?{type:"text",inputmode:"decimal"}:"digit"===r?{type:"tel",inputmode:"numeric"}:{type:r},n),null);var r},fe=()=>{const t=l["right-icon"];if(e.rightIcon||t)return a("div",{class:ne("right-icon"),onClick:ie},[t?t():a(F,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},pe=()=>{if(e.showWordLimit&&e.maxlength){const t=te(k());return a("div",{class:ne("word-limit")},[a("span",{class:ne("word-num")},[t]),g("/"),e.maxlength])}},ve=()=>{if(h&&!1===h.props.showErrorMessage)return;const t=e.errorMessage||p.validateMessage;if(t){const e=l["error-message"],n=S("errorMessageAlign");return a("div",{class:ne("error-message",n)},[e?e({message:t}):t])}},me=()=>[a("div",{class:ne("body")},[ge(),V.value&&a(F,{ref:m,name:e.clearIcon,class:ne("clear")},null),fe(),l.button&&a("div",{class:ne("button")},[l.button()])]),pe(),ve()];return R({blur:J,focus:()=>{var e;return null==(e=v.value)?void 0:e.focus()},validate:O,formValue:q,resetValidation:z,getValidationStatus:()=>p.status}),i(M,{customValue:b,resetValidation:z,validateWithTrigger:H}),s((()=>e.modelValue),(()=>{N(k()),z(),H("onChange"),c(Q)})),u((()=>{N(k(),e.formatTrigger),c(Q)})),L("touchstart",(e=>{E(e),t("update:modelValue",""),t("clear",e)}),{target:o((()=>{var e;return null==(e=m.value)?void 0:e.$el}))}),()=>{const t=S("disabled"),n=S("labelAlign"),r=(()=>{const t=l["left-icon"];if(e.leftIcon||t)return a("div",{class:ne("left-icon"),onClick:oe},[t?t():a(F,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])})();return a(X,{size:e.size,class:ne({error:se.value,disabled:t,[`label-${n}`]:n}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:ce.value,valueClass:ne("value"),titleClass:[ne("label",[n,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:r&&"top"!==n?()=>r:null,title:()=>{const t=(()=>{const t=S("labelWidth"),n=S("labelAlign"),r=S("colon")?":":"";return l.label?[l.label(),r]:e.label?a("label",{id:`${f}-label`,for:de(),style:"top"===n&&t?{width:A(t)}:void 0},[e.label+r]):void 0})();return"top"===n?[r,t].filter(Boolean):t||[]},value:me,extra:l.extra})}}})),[ie,se,ce]=f("search");const ue=k(l({name:ie,props:h({},re,{label:String,shape:p("square"),leftIcon:p("search"),clearable:m,actionText:String,background:String,showAction:Boolean}),emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:l,attrs:n}){const o=K(),i=r(),s=()=>{l.action||(t("update:modelValue",""),t("cancel"))},c=l=>{13===l.keyCode&&(E(l),t("search",e.modelValue))},u=()=>e.id||`${o}-input`,g=()=>{if(l.label||e.label)return a("label",{class:se("label"),for:u()},[l.label?l.label():e.label])},f=()=>{if(e.showAction){const t=e.actionText||ce("cancel");return a("div",{class:se("action"),role:"button",tabindex:0,onClick:s},[l.action?l.action():t])}},p=e=>t("blur",e),v=e=>t("focus",e),m=e=>t("clear",e),b=e=>t("clickInput",e),y=e=>t("clickLeftIcon",e),k=e=>t("clickRightIcon",e),x=Object.keys(re),w=()=>{const r=h({},n,q(e,x),{id:u()});return a(oe,d({ref:i,type:"search",class:se("field"),border:!1,onBlur:p,onFocus:v,onClear:m,onKeypress:c,onClickInput:b,onClickLeftIcon:y,onClickRightIcon:k,"onUpdate:modelValue":e=>t("update:modelValue",e)},r),q(l,["left-icon","right-icon"]))};return R({focus:()=>{var e;return null==(e=i.value)?void 0:e.focus()},blur:()=>{var e;return null==(e=i.value)?void 0:e.blur()}}),()=>{var t;return a("div",{class:se({"show-action":e.showAction}),style:{background:e.background}},[null==(t=l.left)?void 0:t.call(l),a("div",{class:se("content",e.shape)},[g(),w()]),f()])}}})),[de,ge]=f("sidebar"),fe=Symbol(de);const pe=k(l({name:de,props:{modelValue:V(0)},emits:["change","update:modelValue"],setup(e,{emit:t,slots:l}){const{linkChildren:n}=$(fe),r=()=>+e.modelValue;return n({getActive:r,setActive:e=>{e!==r()&&(t("update:modelValue",e),t("change",e))}}),()=>{var e;return a("div",{role:"tablist",class:ge()},[null==(e=l.default)?void 0:e.call(l)])}}})),[ve,me]=f("sidebar-item");const be=k(l({name:ve,props:h({},z,{dot:Boolean,title:String,badge:v,disabled:Boolean,badgeProps:Object}),emits:["click"],setup(e,{emit:t,slots:l}){const n=D(),{parent:r,index:o}=B(fe);if(!r)return;const i=()=>{e.disabled||(t("click",o.value),r.setActive(o.value),n())};return()=>{const{dot:t,badge:n,title:s,disabled:c}=e,u=o.value===r.getActive();return a("div",{role:"tab",class:me({select:u,disabled:c}),tabindex:c?void 0:0,"aria-selected":u,onClick:i},[a(O,d({dot:t,class:me("text"),content:n},e.badgeProps),{default:()=>[l.title?l.title():s]})])}}}));export{ue as S,N as T,pe as a,be as b,K as c,G as u};
