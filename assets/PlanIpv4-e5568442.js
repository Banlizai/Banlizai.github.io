import{u as e,r as a,m as l,M as t}from"./index-0ca45986.js";import{M as s,B as o,x as i,ac as n,Z as u,Y as r,aw as d,U as p,i as c,t as m,a8 as v,aa as f}from"./@arco-design-8dabd30f.js";import{a as j,b as h,c as b}from"./plan-d5704754.js";import{d as y,u as g,t as w,h as _,l as k,o as x,c as V,s as A,w as I,f as C,J as D,C as P,D as U,F as q,R as z,m as B,a1 as E,b as F}from"./@vue-2b41ce19.js";import"./pinia-b3c1485e.js";import"./axios-6371c10e.js";import"./@logicflow-85f8458e.js";import"./ids-ef071351.js";import"./lodash-es-1e3e3aa2.js";import"./preact-5fc9b0bf.js";import"./qs-f981fe00.js";import"./side-channel-01aeb4d9.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-fae29077.js";import"./object-inspect-0eda087e.js";import"./dayjs-094145ee.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-70e2faff.js";import"./@vueuse-ca9a384d.js";import"./tiny-emitter-35dc7566.js";import"./echarts-24943dbb.js";import"./zrender-2d3b2bba.js";import"./tslib-a4e99503.js";import"./xgplayer-700bd6a3.js";import"./delegate-ef66b241.js";import"./downloadjs-91c0ea73.js";import"./quill-ecb3881d.js";import"./sortablejs-2f5483e3.js";import"./b-tween-5055d79e.js";import"./b-validate-457088db.js";import"./resize-observer-polyfill-ad543aa3.js";import"./scroll-into-view-if-needed-59a60a09.js";import"./compute-scroll-into-view-2962e95c.js";import"./number-precision-d9b928a1.js";const J={class:"w-full h-full"},L={class:"flex justify-between"},M=C("span",null," IPV4网段分配列表",-1),O=C("div",null,"子网掩码",-1),R=y({__name:"PlanIpv4",props:{columns:{type:Array,default:()=>[]}},emits:["update"],setup(y,{emit:R}){const S=y,$=g([]),H=g([]),{columns:K}=w(S),{ADD:N}=t,Y=g(null),Z=e(),G=g(!1),Q=g();function T(){var e;Z.title=N,null==(e=Y.value)||e.show()}function W(){Q.value=void 0,X()}async function X(){try{G.value=!0;const{rows:e}=await j({subnetAddress:Q.value});return K.value.find((l=>{"segmentId"!==l.key||(l.optionItems=a(e,"id","subnetAddress"))})),H.value=a(e,"id","subnetAddress"),$.value=e.filter(((e,a)=>0===a)).map((e=>e.id)),K.value.find((a=>{"segmentId"!==a.key||(a.searchValue=e[0].id)})),G.value=!1,Promise.resolve(e)}catch(e){}}async function ee(e,a){$.value=e,K.value.forEach((a=>{"segmentId"===a.key&&(a.searchValue=e[0])})),R("update")}const ae=g({ipAddress:[{label:"ip1",value:void 0},{label:"ip2",value:void 0},{label:"ip3",value:void 0},{label:"ip4",value:void 0}],mask:void 0}),le=async()=>{var e;const{ipAddress:a,mask:l}=ae.value;if(a.some((e=>void 0!==e.value))&&l)try{const t=F((()=>`${a.map((e=>e.value)).join(".")}/${l}`));if(H.value.some((e=>e.title===t.value)))return void s.error("该条已存在");const{msg:o}=await b({subnetAddress:t.value});s.success(o),null==(e=Y.value)||e.close(),X().then((e=>{(null==e?void 0:e.length)&&R("update")})),oe()}catch(t){}else s.error("请填写完整信息")},te=g();function se(e,a,l){}function oe(){ae.value.ipAddress=[{value:void 0},{value:void 0},{value:void 0},{value:void 0}],ae.value.mask=void 0}return _((()=>{X().then((e=>{(null==e?void 0:e.length)&&R("update")}))})),(e,a)=>{const t=k("icon-plus"),j=o,b=i,y=n,g=u,w=k("icon-right"),_=r,F=k("IconDelete"),S=d,K=p,N=c,ie=k("icon-refresh"),ne=m,ue=k("icon-oblique-line"),re=v,de=f,pe=l;return x(),V(q,null,[A(N,{"header-style":{height:"100px"},loading:G.value,hoverable:"",title:"IPV4网段分配列表"},{title:I((()=>[C("div",J,[A(g,{direction:"vertical",fill:""},{default:I((()=>[C("div",L,[M,A(b,{content:"添加网段",position:"top",mini:""},{default:I((()=>[A(j,{type:"text",onClick:T},{default:I((()=>[A(t)])),_:1})])),_:1})]),A(y,{modelValue:Q.value,"onUpdate:modelValue":a[0]||(a[0]=e=>Q.value=e),placeholder:"请输入网段关键字","allow-clear":"",onClear:W,"search-button":"",loading:G.value,onSearch:X},null,8,["modelValue","loading"])])),_:1})])])),default:I((()=>[A(K,{loading:G.value,blockNode:"",data:H.value,"default-expand-all":"","selected-keys":$.value,"onUpdate:selectedKeys":a[1]||(a[1]=e=>$.value=e),virtualListProps:{height:700},onSelect:ee},{title:I((({title:e,id:a})=>[A(_,{color:a===$.value[0]?"arcoblue":"",close:""},D({default:I((()=>[P(" "+U(e),1)])),_:2},[a===$.value[0]?{name:"icon",fn:I((()=>[A(w)])),key:"0"}:void 0]),1032,["color"])])),extra:I((({id:e})=>[A(b,{content:"删除网段",position:"top",mini:""},{default:I((()=>[A(S,{onOk:a=>async function(e){try{const{msg:a}=await h(e);s.success(a),X().then((e=>{(null==e?void 0:e.length)&&R("update")}))}catch(a){}}(e),type:"warning",content:"是否确认删除此网段(包括网段下所有IP)？"},{default:I((()=>[A(j,{type:"text"},{default:I((()=>[A(F)])),_:1})])),_:2},1032,["onOk"])])),_:2},1024)])),_:1},8,["loading","data","selected-keys"])])),_:1},8,["loading"]),A(pe,{ref_key:"modalDialog",ref:Y,config:E(Z),onConfirm:le},{content:I((()=>[A(de,{ref_key:"ipv4Ref",ref:te,layout:"vertical",model:ae.value},{default:I((()=>[A(re,{label:"子网地址",required:""},{label:I((()=>[A(g,null,{default:I((()=>[O,A(b,{placement:"topLeft",content:"重置"},{default:I((()=>[A(j,{type:"text",onClick:oe},{default:I((()=>[A(ie)])),_:1})])),_:1})])),_:1})])),default:I((()=>[A(g,null,{default:I((()=>[(x(!0),V(q,null,z(ae.value.ipAddress,(e=>(x(),B(ne,{key:e.label,class:"w-16","max-length":3,"hide-button":"",precision:0,modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,onInput:se},null,8,["modelValue","onUpdate:modelValue"])))),128)),A(ue),A(ne,{class:"w-20","max-length":2,min:24,max:32,precision:0,"hide-button":"",modelValue:ae.value.mask,"onUpdate:modelValue":a[2]||(a[2]=e=>ae.value.mask=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["config"])],64)}}});export{R as default};
