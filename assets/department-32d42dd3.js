import{I as e,_ as a,p as t,e as l,k as o,m as d}from"./index-4d88e5a9.js";import{c as s,M as i,f as n,a9 as r,Z as m,_ as p,a0 as u,x as c,X as f,Q as j,w as g,aw as v,ax as _,Y as b}from"./@arco-design-306c64c5.js";import{b as h,c as y,d as k}from"./table-76ae527c.js";import{p as C}from"./http-5a7406c8.js";import{l as I}from"./lodash-es-6e445b1b.js";import{e as x,a as w,r as V,o as M,k as D,p as L,v as A,m as U,F,R as q,l as E,G as O,y as z,z as G}from"./@vue-ab7141bd.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-74931cc0.js";import"./pinia-c1bb2998.js";import"./@vueuse-96027ebb.js";import"./axios-7fb8d0b2.js";import"./@logicflow-435513e4.js";import"./ids-ef071351.js";import"./preact-173f4f0b.js";import"./qs-536c1183.js";import"./side-channel-52a2f2e5.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-d34af9d2.js";import"./object-inspect-a85657d3.js";import"./mockjs-a6500710.js";import"./tiny-emitter-af47831f.js";import"./xgplayer-474fd437.js";import"./quill-daa56216.js";import"./sortablejs-2f5483e3.js";import"./resize-observer-polyfill-ad543aa3.js";import"./compute-scroll-into-view-2962e95c.js";import"./b-tween-5055d79e.js";import"./dayjs-f47c42f6.js";import"./b-validate-42052d35.js";import"./number-precision-d9b928a1.js";import"./scroll-into-view-if-needed-59a60a09.js";const R=x({name:"Department",setup(){const a=h(),t=y([{title:"部门名称",key:"name",dataIndex:"name"},{title:"部门编号",key:"depCode",dataIndex:"depCode"},{title:"排序",key:"order",dataIndex:"order"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"actions",dataIndex:"actions"}]),l=w({parentId:void 0,id:0,name:"",depCode:"",order:1,status:1}),o=V(),d=V(),n=k("id"),r=V(null),m=C;function p(e,a){for(let t=0;t<e.length;t++){const l=e[t];if(l.id===a.id)return I.isEmpty(l.children)?void e.splice(t,1):void i.error("当前部门下有子部门，不能删除");I.isEmpty(l.children)||p(l.children,a)}}return M((function(){m({url:e}).then((({data:e=[]})=>(a.tableLoading.value=!1,a.dataList.length=0,a.dataList.push(...e),e)))})),{DP_CODE_FLAG:"dp_code_",formRef:o,dialogTitle:d,departmentModel:l,...a,rowKey:n,tableColumns:t,onUpdateItem:function(e){var a;d.value="编辑部门",Object.keys(e).forEach((a=>{l[a]=e[a]})),l.parentId=e.parentId,null==(a=r.value)||a.toggle()},onDataFormConfirm:function(){var e;null==(e=o.value)||e.validate().then((e=>{var a;e||(null==(a=r.value)||a.close(),i.success("模拟部门添加/编辑成功，数据为："+JSON.stringify(l)))})).catch((e=>{}))},onDeleteItem:e=>{s.confirm({title:"提示",content:"确定要删除此信息，删除后不可恢复？",onOk(){p(a.dataList,e)}})},onAddItem:function(){var e;d.value="添加部门",l.parentId=void 0,l.id=0,l.status=1,l.depCode="",l.name="",l.order=1,null==(e=r.value)||e.toggle()},modalDialog:r}}}),K={class:"main-container"};const P=a(R,[["render",function(e,a,s,i,h,y){const k=t,C=l,I=n,x=r,w=m,V=p,M=o,R=u,P=c,T=f,B=j,H=g,J=v,N=_,Q=b,S=d;return D(),L("div",K,[A(M,null,{header:U((()=>[A(C,{"show-filter":!1},{"table-config":U((()=>[A(k,{onAdd:e.onAddItem},null,8,["onAdd"])])),_:1})])),default:U((()=>[A(V,{bordered:!1,loading:e.tableLoading,data:e.dataList,"row-key":e.rowKey,pagination:!1},{columns:U((()=>[(D(!0),L(F,null,q(e.tableColumns,(a=>(D(),E(w,{key:a.key,align:a.align,title:a.title,width:a.width,"data-index":a.key,fixed:a.fixed},O({_:2},["actions"===a.key?{name:"cell",fn:U((({record:a})=>[A(x,null,{default:U((()=>[A(I,{status:"success",onClick:t=>e.onUpdateItem(a)},{default:U((()=>[z(" 编辑 ")])),_:2},1032,["onClick"]),A(I,{status:"danger",onClick:t=>e.onDeleteItem(a)},{default:U((()=>[z(" 删除 ")])),_:2},1032,["onClick"])])),_:2},1024)])),key:"0"}:void 0]),1032,["align","title","width","data-index","fixed"])))),128))])),_:1},8,["loading","data","row-key"])])),_:1}),A(S,{ref:"modalDialog",title:e.dialogTitle,onConfirm:e.onDataFormConfirm},{content:U((()=>[A(Q,{ref:"formRef",model:e.departmentModel,labelCol:{span:4}},{default:U((()=>[A(T,{label:"上级部门",name:"parentId"},{default:U((()=>[A(P,{modelValue:e.departmentModel.parentId,"onUpdate:modelValue":a[0]||(a[0]=a=>e.departmentModel.parentId=a),placeholder:"请选择上级部门"},{default:U((()=>[(D(!0),L(F,null,q(e.dataList,(e=>(D(),E(R,{key:e.id,value:e.id},{default:U((()=>[z(G(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1}),A(T,{label:"部门名称",field:"name",rules:[{required:!0,message:"请输入部门名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}],"validate-trigger":["change","input"]},{default:U((()=>[A(B,{placeholder:"请输入部门名称",modelValue:e.departmentModel.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.departmentModel.name=a)},null,8,["modelValue"])])),_:1}),A(T,{label:"部门编号",field:"depCode",rules:[{required:!0,message:"请输入部门编号"},{min:3,max:10,message:"长度在 3 - 30个字符"}],"validate-trigger":["change","input"]},{default:U((()=>[A(B,{placeholder:"请输入部门编号",modelValue:e.departmentModel.depCode,"onUpdate:modelValue":a[2]||(a[2]=a=>e.departmentModel.depCode=a)},{prepend:U((()=>[z(G(e.DP_CODE_FLAG),1)])),_:1},8,["modelValue"])])),_:1}),A(T,{label:"排序",name:"order"},{default:U((()=>[A(H,{modelValue:e.departmentModel.order,"onUpdate:modelValue":a[3]||(a[3]=a=>e.departmentModel.order=a)},null,8,["modelValue"])])),_:1}),A(T,{label:"状态",name:"status"},{default:U((()=>[A(N,{modelValue:e.departmentModel.status,"onUpdate:modelValue":a[4]||(a[4]=a=>e.departmentModel.status=a)},{default:U((()=>[A(J,{value:1},{default:U((()=>[z("正常")])),_:1}),A(J,{value:0},{default:U((()=>[z("禁用")])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","onConfirm"])])}],["__scopeId","data-v-b1e28bba"]]);export{P as default};
