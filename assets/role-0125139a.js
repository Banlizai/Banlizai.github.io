import{p as S}from"./http-79937b7b.js";import{p as $,_ as q}from"./index-09e9d0bf.js";import{b as z,c as G,d as H}from"./table-d5bdf2e1.js";import{M as b,h as J}from"./@arco-design-f5decd74.js";import{e as j,r as c,o as P,C as Q,j as n,k as f,p as V,v as u,m as o,F as O,R as B,l as C,G as K,y,z as L,n as W,u as X,s as U}from"./@vue-0366cb61.js";import"./path-browserify-188d1ff8.js";import"./vue-router-5bfb708a.js";import"./axios-0bf28a1e.js";import"./@logicflow-5cdfeb8e.js";import"./ids-46106237.js";import"./preact-b8060ab3.js";import"./qs-b99d1803.js";import"./side-channel-5f245a46.js";import"./get-intrinsic-b9397c9a.js";import"./has-symbols-e8f3ca0e.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-9ceb8f5b.js";import"./object-inspect-8530d459.js";import"./pinia-16e4d8ec.js";import"./@vueuse-945dd224.js";import"./mockjs-417a16d8.js";import"./tiny-emitter-6d407e5e.js";import"./xgplayer-cee6bcaa.js";import"./quill-9354d83a.js";import"./sortablejs-be94e56d.js";import"./lodash-es-734afc83.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./compute-scroll-into-view-183f845a.js";import"./b-tween-aacd5abe.js";import"./dayjs-bf5be20d.js";import"./b-validate-48f29bf6.js";import"./number-precision-7e656275.js";import"./scroll-into-view-if-needed-6b992d05.js";const A="ROLE_",g=[{label:"角色名称",type:"input",key:"name",value:c(""),required:!0,placeholder:"请输入角色名称",validator:function(){return this.value.value?!0:(b.error(this.placeholder||""),!1)}},{label:"角色编号",key:"roleCode",value:c(""),type:"input",required:!0,placeholder:"请输入角色编号",validator:function(){return this.value.value?!0:(b.error(this.placeholder||""),!1)}},{label:"角色描述",key:"description",value:c(""),type:"textarea",placeholder:"请输入角色描述"}];function N(a,i,p){const k=[];return a.forEach(m=>{const s={};s.key=m.menuUrl,s.title=m.menuName,i.push(s.key),m.children&&(p.push(s.key),s.children=N(m.children,i,p)),k.push(s)}),k}const Y=j({name:"Role",setup(){const a=c(null),i=c(null),p=z(),k=H("id"),m=c("添加角色"),s=c([]),D=G([p.indexColumn,{title:"角色名称",key:"name",dataIndex:"name"},{title:"角色编号",key:"roleCode",dataIndex:"roleCode"},{title:"角色描述",key:"description",dataIndex:"description"},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"操作",key:"actions",dataIndex:"actions"}]),_=c([]),v=c([]),h=c({});async function M(){p.handleSuccess({code:200,data:[{id:1,name:"超级管理员",roleCode:"ROLE_admin",description:"超级管理员"},{id:2,name:"编辑员",roleCode:"ROLE_editor",description:"编辑员"}],msg:"获取数据成功"})}function R(){var l;m.value="添加角色",(l=a.value)==null||l.toggle(),g.forEach(t=>{t.reset?t.reset():t.value.value=""})}function w(l){var t;m.value="编辑角色",(t=a.value)==null||t.toggle(),Q(()=>{g.forEach(r=>{const x=r.key,e=l[x];e&&(r.key==="roleCode"?r.value.value=e.replace(A,""):r.value.value=e)})})}function I(l){J.confirm({title:"提示",content:"是否要删除此角色？",cancelText:"取消",okText:"删除",onOk:()=>{b.success("模拟角色删除成功，参数为"+JSON.stringify(l))}})}function T(){var l;g.every(t=>t.validator?t.validator():!0)&&((l=a.value)==null||l.toggle(),b.success("模拟菜单添加成功，参数为："+JSON.stringify(g.reduce((t,r)=>(t[r.key]=r.value.value,t),{}))))}function E(l){S({url:$,data:{roleId:l.id}}).then(t=>{var r;s.value=[],_.value=[],v.value=[],s.value=N(t.data,_.value,v.value),(r=i.value)==null||r.toggle()}).catch(console.log)}return P(M),{ROLE_CODE_FLAG:A,modalDialogRef:a,menuModalDialogRef:i,rowKey:k,formModel:h,menuData:s,tableColumns:D,formItems:g,actionTitle:m,defaultCheckedKeys:_,defaultExpandedKeys:v,...p,onAddItem:R,onDataFormConfirm:T,onShowMenu:E,onDeleteItem:I,onUpdateItem:w}}}),Z={class:"main-container"};function ee(a,i,p,k,m,s){const D=n("AddButton"),_=n("TableHeader"),v=n("a-avatar"),h=n("a-button"),M=n("a-space"),R=n("a-table-column"),w=n("a-table"),I=n("TableBody"),T=n("a-input"),E=n("a-textarea"),l=n("a-form-item"),t=n("a-form"),r=n("ModalDialog"),x=n("a-tree");return f(),V("div",Z,[u(I,null,{header:o(()=>[u(_,{"show-filter":!1},{"table-config":o(()=>[u(D,{onAdd:a.onAddItem},null,8,["onAdd"])]),_:1})]),default:o(()=>[u(w,{bordered:!1,loading:a.tableLoading,data:a.dataList,pagination:!1,"row-key":a.rowKey},{columns:o(()=>[(f(!0),V(O,null,B(a.tableColumns,e=>(f(),C(R,{key:e.key,align:e.align,title:e.title,width:e.width,"data-index":e.key,fixed:e.fixed},K({_:2},[e.key==="index"?{name:"cell",fn:o(({rowIndex:d})=>[y(L(d+1),1)]),key:"0"}:e.key==="gender"?{name:"cell",fn:o(({record:d})=>[y(L(d.gender===1?"男":"女"),1)]),key:"1"}:e.key==="avatar"?{name:"cell",fn:o(({record:d})=>[u(v,null,{default:o(()=>[W("img",{src:d.avatar},null,8,["src"])]),_:2},1024)]),key:"2"}:e.key==="actions"?{name:"cell",fn:o(({record:d})=>[u(M,null,{default:o(()=>[u(h,{status:"success",onClick:F=>a.onUpdateItem(d)},{default:o(()=>[y("编辑")]),_:2},1032,["onClick"]),u(h,{status:"danger",onClick:F=>a.onDeleteItem(d)},{default:o(()=>[y("删除")]),_:2},1032,["onClick"]),u(h,{status:"warning",onClick:F=>a.onShowMenu(d)},{default:o(()=>[y(" 菜单权限 ")]),_:2},1032,["onClick"])]),_:2},1024)]),key:"3"}:void 0]),1032,["align","title","width","data-index","fixed"]))),128))]),_:1},8,["loading","data","row-key"])]),_:1}),u(r,{ref:"modalDialogRef",title:a.actionTitle,onConfirm:a.onDataFormConfirm},{content:o(()=>[u(t,{model:a.formModel},{default:o(()=>[(f(!0),V(O,null,B(a.formItems,e=>(f(),C(l,{class:X([e.required?"form-item__require":"form-item__no_require"]),label:e.label,key:e.key},{default:o(()=>[e.type==="input"?(f(),C(T,{key:0,placeholder:e.placeholder,modelValue:e.value.value,"onUpdate:modelValue":d=>e.value.value=d},K({_:2},[e.key==="roleCode"?{name:"prepend",fn:o(()=>[y(L(a.ROLE_CODE_FLAG),1)]),key:"0"}:void 0]),1032,["placeholder","modelValue","onUpdate:modelValue"])):U("",!0),e.type==="textarea"?(f(),C(E,{key:1,modelValue:e.value.value,"onUpdate:modelValue":d=>e.value.value=d,placeholder:e.placeholder,"auto-size":{minRows:3,maxRows:5}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):U("",!0)]),_:2},1032,["class","label"]))),128))]),_:1},8,["model"])]),_:1},8,["title","onConfirm"]),u(r,{ref:"menuModalDialogRef",title:"编辑菜单权限"},{content:o(()=>[u(x,{data:a.menuData,checkable:"","expanded-keys":a.defaultExpandedKeys,"onUpdate:expandedKeys":i[0]||(i[0]=e=>a.defaultExpandedKeys=e),"checked-keys":a.defaultCheckedKeys,"onUpdate:checkedKeys":i[1]||(i[1]=e=>a.defaultCheckedKeys=e)},null,8,["data","expanded-keys","checked-keys"])]),_:1},512)])}const Be=q(Y,[["render",ee]]);export{Be as default};
