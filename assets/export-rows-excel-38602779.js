import{g as e,_ as t,e as s,k as a}from"./index-4d88e5a9.js";import{M as o,f as i,A as r,ab as n,Z as l,_ as d}from"./@arco-design-306c64c5.js";import{p as m}from"./http-5a7406c8.js";import{b as c,a as p,c as u,d as j}from"./table-76ae527c.js";import{X as y}from"./xlsx-44ece581.js";import{e as f,r as k,o as g,k as x,p as b,v as h,m as w,y as v,F as _,R as I,l as C,G as L,z as R}from"./@vue-ab7141bd.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-74931cc0.js";import"./pinia-c1bb2998.js";import"./@vueuse-96027ebb.js";import"./axios-7fb8d0b2.js";import"./@logicflow-435513e4.js";import"./ids-ef071351.js";import"./preact-173f4f0b.js";import"./qs-536c1183.js";import"./side-channel-52a2f2e5.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-d34af9d2.js";import"./object-inspect-a85657d3.js";import"./mockjs-a6500710.js";import"./tiny-emitter-af47831f.js";import"./xgplayer-474fd437.js";import"./quill-daa56216.js";import"./sortablejs-2f5483e3.js";import"./lodash-es-6e445b1b.js";import"./resize-observer-polyfill-ad543aa3.js";import"./compute-scroll-into-view-2962e95c.js";import"./b-tween-5055d79e.js";import"./dayjs-f47c42f6.js";import"./b-validate-42052d35.js";import"./number-precision-d9b928a1.js";import"./scroll-into-view-if-needed-59a60a09.js";const S=f({name:"ExportRowsExcel",setup(){const t=k(null),s=c(),{selectedRowKeys:a,onSelectionChange:i}=p(),r=j("id"),n=u([s.indexColumn,{title:"名称",key:"nickName",dataIndex:"nickName"},{title:"性别",key:"gender",dataIndex:"gender"},{title:"地址",key:"address",dataIndex:"address"},{title:"登录时间",key:"lastLoginTime",dataIndex:"lastLoginTime"},{title:"登录IP",key:"lastLoginIp",dataIndex:"lastLoginIp"},{title:"状态",key:"status",dataIndex:"status"}]);return g((function(){m({url:e,data:{page:1,pageSize:20}}).then(s.handleSuccess).catch(console.log)})),{tableRef:t,...s,selectedRowKeys:a,onSelectionChange:i,tableColumns:n,rowKey:r,exportExcel:function(){if(0===a.value.length)return void o.error("请选择要导出的行");const e=a.value.map((e=>s.dataList.find((t=>t.id===e)))).map((e=>[e.nickName,0===e.gender?"男":"女",e.address,e.lastLoginTime,e.lastLoginIp]));e.unshift(["昵称","性别","地址","上次登录时间","上次登录IP"]);const t=y.utils.aoa_to_sheet(e),i=y.utils.book_new();y.utils.book_append_sheet(i,t,"数据报表"),y.writeFile(i,"table-list.xlsx")}}}}),K={class:"main-container"};const E=t(S,[["render",function(e,t,o,m,c,p){const u=i,j=s,y=r,f=n,k=l,g=d,S=a;return x(),b("div",K,[h(j,{"show-filter":!1},{"table-config":w((()=>[h(u,{type:"primary",onClick:e.exportExcel},{default:w((()=>[v("导出选中的Excel ")])),_:1},8,["onClick"])])),_:1}),h(S,null,{default:w((()=>[h(g,{ref:"tableRef",data:e.dataList,pagination:!1,"row-key":e.rowKey,"row-selection":{selectedRowKeys:e.selectedRowKeys},onSelectionChange:e.onSelectionChange},{columns:w((()=>[(x(!0),b(_,null,I(e.tableColumns,(e=>(x(),C(k,{key:e.key,align:"center",title:e.title,"data-index":e.key},L({_:2},["index"===e.key?{name:"cell",fn:w((({rowIndex:e})=>[v(R(e+1),1)])),key:"0"}:"gender"===e.key?{name:"cell",fn:w((({record:e})=>[v(R(1===e.gender?"男":"女"),1)])),key:"1"}:"avatar"===e.key?{name:"cell",fn:w((({record:e})=>[h(y,{src:e.avatar},null,8,["src"])])),key:"2"}:"status"===e.key?{name:"cell",fn:w((({record:e})=>[1===e.status?(x(),C(f,{key:0,color:"blue"},{default:w((()=>[v("正常")])),_:1})):(x(),C(f,{key:1,color:"red"},{default:w((()=>[v("禁用")])),_:1}))])),key:"3"}:void 0]),1032,["title","data-index"])))),128))])),_:1},8,["data","row-key","row-selection","onSelectionChange"])])),_:1})])}]]);export{E as default};
