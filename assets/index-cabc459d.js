import{g as e,p as a,_ as t,u as o,a as s,b as l,c as r,d as n,e as i,f as d,h as c,i as u,j as m,k as p,l as v,m as j,M as y}from"./index-0ca45986.js";import{M as f,n as h,T as b,c as g,B as w,Y as C}from"./@arco-design-8dabd30f.js";import{u as _,a as k,b as R,c as S,d as x,e as A}from"./columns-1685844f.js";import{d as D,ar as T,u as L,b as V,h as E,a_ as U,o as K,c as z,f as B,s as I,w as q,N as P,m as M,C as O,a1 as F,D as N,q as $,F as H,r as J}from"./@vue-2b41ce19.js";import"./pinia-b3c1485e.js";import"./axios-6371c10e.js";import"./@logicflow-85f8458e.js";import"./ids-ef071351.js";import"./lodash-es-1e3e3aa2.js";import"./preact-5fc9b0bf.js";import"./qs-f981fe00.js";import"./side-channel-01aeb4d9.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-fae29077.js";import"./object-inspect-0eda087e.js";import"./dayjs-094145ee.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-70e2faff.js";import"./@vueuse-ca9a384d.js";import"./tiny-emitter-35dc7566.js";import"./echarts-24943dbb.js";import"./zrender-2d3b2bba.js";import"./tslib-a4e99503.js";import"./xgplayer-700bd6a3.js";import"./delegate-ef66b241.js";import"./downloadjs-91c0ea73.js";import"./quill-ecb3881d.js";import"./sortablejs-2f5483e3.js";import"./b-tween-5055d79e.js";import"./b-validate-457088db.js";import"./resize-observer-polyfill-ad543aa3.js";import"./scroll-into-view-if-needed-59a60a09.js";import"./compute-scroll-into-view-2962e95c.js";import"./number-precision-d9b928a1.js";import"./dict-9c237ae6.js";const Y={class:"main-container"},G=D({__name:"index",setup(D){const G=T((()=>t((()=>import("./AlarmDetails-9247627e.js")),["assets/AlarmDetails-9247627e.js","assets/@arco-design-8dabd30f.js","assets/@vue-2b41ce19.js","assets/b-tween-5055d79e.js","assets/b-validate-457088db.js","assets/resize-observer-polyfill-ad543aa3.js","assets/scroll-into-view-if-needed-59a60a09.js","assets/compute-scroll-into-view-2962e95c.js","assets/number-precision-d9b928a1.js","assets/dayjs-094145ee.js","assets/@logicflow-85f8458e.js","assets/ids-ef071351.js","assets/lodash-es-1e3e3aa2.js","assets/preact-5fc9b0bf.js","assets/@logicflow-4fbf093d.css","assets/@arco-design-766c8d5e.css"]))),Q=L("notRestored"),W=L([]),{selectedRowKeys:X,onSelectionChange:Z,showCheckedAll:ee}=_(),{ADD:ae,UPDATE:te,ALERTDETAILS:oe}=y,se=o(),le=L(null),re=k(be),ne=R(),{bordered:ie,striped:de,handleSuccess:ce,tableLoading:ue,dataList:me}=ne,pe=A("id"),{notRestored:ve,restored:je}=S(),ye=V((()=>"notRestored"===Q.value?ve:je)),{onSorterChange:fe,sortOrder:he}=x(be);async function be(){ue.value=!0;const a={pageNum:re.page,pageSize:re.pageSize,orderByColumn:he.orderBy,isAsc:he.isAsc,...l(ye.value)};try{const t="notRestored"===Q.value?await(async a=>await e({url:"/alarm/listUnRecover",data:a}))(a):await(async a=>await e({url:"/alarm/listRecover",data:a}))(a),{code:o,rows:s,msg:l,total:r}=t,n={code:o,msg:l,data:s};ue.value=!1,ce(J(n)),re.setTotalSize(r||10)}catch(t){}}function ge(){ye.value.forEach((e=>{e.searchReset?e.searchReset():e.searchValue=""})),be()}function we(){var e;null==(e=le.value)||e.close()}function Ce(){const e="notRestored"===Q.value?r:n,a="notRestored"===Q.value?"告警-未恢复":"告警-已恢复";try{i(e,l(ye.value),a)}catch(t){}}async function _e(){const e=X.value.toString();e?h.confirm({title:"提示",content:"是否对选中告警进行确认操作？",cancelText:"取消",okText:"确认",onOk:async()=>{try{const{msg:t}=await(async e=>await a({url:`/alarm/${e}`}))(e);f.success(t),be(),X.value=[]}catch(t){}}}):f.error("请选择告警")}async function ke(a){var t,o,s,l,r;const n=a.id;se.title=oe,null==(t=le.value)||t.show();try{const{data:a}=await(async a=>await e({url:`/alarm/${a}`}))(n),t=[{label:"告警内容",value:a.content},{label:"告警级别",value:null==(l=null==(s=null==(o=ye.value.find((e=>"level"===e.key)))?void 0:o.optionItems)?void 0:s.find((e=>e.value===a.level)))?void 0:l.label},{label:"产生时间",value:a.collectTime},{label:"IP地址",value:a.sourceIp},{label:"监控类型",value:a.childCategory},{label:"告警来源",value:a.name}];W.value=t}catch(i){null==(r=le.value)||r.close()}}return E(be),(e,a)=>{const t=b,o=g,l=d,r=w,n=c,i=u,y=C,f=m,h=p,_=v,k=j,R=U("hasPerm");return K(),z(H,null,[B("div",Y,[I(_,{ref:"tableBody"},{header:q((()=>[I(i,{"show-filter":!0,title:"",onSearch:be,onResetSearch:ge},{"card-left":q((()=>[I(o,{type:"rounded","active-key":Q.value,"onUpdate:activeKey":a[0]||(a[0]=e=>Q.value=e),"default-active-key":"notRestored","hide-content":"",animation:"",onTabClick:be},{default:q((()=>[I(t,{key:"notRestored",title:"告警-未恢复"}),I(t,{key:"restored",title:"告警-已恢复"})])),_:1},8,["active-key"])])),"search-content":q((()=>[I(l,{modelValue:ye.value,"onUpdate:modelValue":a[1]||(a[1]=e=>ye.value=e)},null,8,["modelValue"])])),"more-button-content":q((()=>[P((K(),M(r,{type:"primary",onClick:_e},{default:q((()=>[O("确认告警")])),_:1})),[[R,["alarm:index:submit"]]]),P((K(),M(r,{type:"primary",loading:F(s),onClick:Ce},{default:q((()=>[O(" 导出告警 ")])),_:1},8,["loading"])),[[R,["alarm:index:export"]]])])),"table-config":q((()=>[I(n,{tableColumns:ye.value,"onUpdate:border":a[2]||(a[2]=e=>F(ne).bordered.value=e),"onUpdate:striped":a[3]||(a[3]=e=>F(ne).striped.value=e),onDoRefresh:be},null,8,["tableColumns"])])),_:1})])),default:q((()=>[I(f,{bordered:F(ie),striped:F(de),tableLoading:F(ue),dataList:F(me),tableColumns:ye.value,rowKey:F(pe),onSelectionChange:F(Z),onSorterChange:F(fe),selectedRowKeys:F(X),showCheckedAll:F(ee)},{level:q((({record:e})=>[I(y,{color:1===e.level?"orange":"red"},{default:q((()=>[O(N(1===e.level?"一般":"严重"),1)])),_:2},1032,["color"])])),orderStatus:q((({record:e})=>[1===e.orderStatus?(K(),M(y,{key:0},{default:q((()=>[O(" 未下发 ")])),_:1})):2===e.orderStatus?(K(),M(y,{key:1},{default:q((()=>[O(" 处理中 ")])),_:1})):3===e.orderStatus?(K(),M(y,{key:2},{default:q((()=>[O(" 已处理 ")])),_:1})):$("",!0)])),content:q((({record:e})=>[I(r,{type:"text",onClick:a=>ke(e)},{default:q((()=>[O(N(e.content),1)])),_:2},1032,["onClick"])])),_:1},8,["bordered","striped","tableLoading","dataList","tableColumns","rowKey","onSelectionChange","onSorterChange","selectedRowKeys","showCheckedAll"])])),footer:q((()=>[I(h,{pagination:F(re)},null,8,["pagination"])])),_:1},512)]),I(k,{ref_key:"modalDialog",ref:le,config:F(se),onConfirm:we},{content:q((()=>[I(F(G),{modelValue:W.value,"onUpdate:modelValue":a[4]||(a[4]=e=>W.value=e)},null,8,["modelValue"])])),_:1},8,["config"])],64)}}});export{G as default};
