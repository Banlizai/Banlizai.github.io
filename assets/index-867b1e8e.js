import{_ as e,u as t,b as a,f as s,h as i,i as o,j as n,k as p,l,m as r,M as c,n as u}from"./index-0ca45986.js";import{M as d,n as y,T as v,c as m,B as T,x as f,v as h,Y as j,Z as b,aa as g}from"./@arco-design-8dabd30f.js";import{d as C,ar as M,u as _,p as w,b as k,h as D,l as S,o as P,c as x,f as E,s as H,w as R,J as O,a1 as L,C as V,D as I,m as Y,N as F,O as U,K as A,F as z,r as B,aX as N,aV as K}from"./@vue-2b41ce19.js";import{a as W,b as q,d as J,c as X,e as Z}from"./columns-1685844f.js";import{d as $}from"./dayjs-094145ee.js";import{c as G,d as Q,e as ee,f as te,g as ae,h as se,i as ie,j as oe}from"./index-55fae50f.js";import{b as ne}from"./user-38648499.js";import{u as pe}from"./dict-9c237ae6.js";import"./pinia-b3c1485e.js";import"./axios-6371c10e.js";import"./@logicflow-85f8458e.js";import"./ids-ef071351.js";import"./lodash-es-1e3e3aa2.js";import"./preact-5fc9b0bf.js";import"./qs-f981fe00.js";import"./side-channel-01aeb4d9.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-fae29077.js";import"./object-inspect-0eda087e.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-70e2faff.js";import"./@vueuse-ca9a384d.js";import"./tiny-emitter-35dc7566.js";import"./echarts-24943dbb.js";import"./zrender-2d3b2bba.js";import"./tslib-a4e99503.js";import"./xgplayer-700bd6a3.js";import"./delegate-ef66b241.js";import"./downloadjs-91c0ea73.js";import"./quill-ecb3881d.js";import"./sortablejs-2f5483e3.js";import"./b-tween-5055d79e.js";import"./b-validate-457088db.js";import"./resize-observer-polyfill-ad543aa3.js";import"./scroll-into-view-if-needed-59a60a09.js";import"./compute-scroll-into-view-2962e95c.js";import"./number-precision-d9b928a1.js";const le={class:"main-container"},re={class:"flex justify-end py-2 absolute bottom-0 right-0 w-full footer"},ce=(e=>(N("data-v-485597bf"),e=e(),K(),e))((()=>E("div",null,null,-1))),ue=u(C({__name:"index",setup(u){const C=M((()=>e((()=>import("./PlanControls-93fed23a.js")),["assets/PlanControls-93fed23a.js","assets/index-0ca45986.js","assets/@vue-2b41ce19.js","assets/@arco-design-8dabd30f.js","assets/b-tween-5055d79e.js","assets/b-validate-457088db.js","assets/resize-observer-polyfill-ad543aa3.js","assets/scroll-into-view-if-needed-59a60a09.js","assets/compute-scroll-into-view-2962e95c.js","assets/number-precision-d9b928a1.js","assets/dayjs-094145ee.js","assets/@logicflow-85f8458e.js","assets/ids-ef071351.js","assets/lodash-es-1e3e3aa2.js","assets/preact-5fc9b0bf.js","assets/@logicflow-4fbf093d.css","assets/@arco-design-766c8d5e.css","assets/pinia-b3c1485e.js","assets/axios-6371c10e.js","assets/qs-f981fe00.js","assets/side-channel-01aeb4d9.js","assets/get-intrinsic-bac01933.js","assets/has-symbols-456daba2.js","assets/has-proto-4a87f140.js","assets/function-bind-72d06d3b.js","assets/has-885c3436.js","assets/call-bind-fae29077.js","assets/object-inspect-0eda087e.js","assets/path-browserify-8c7c24dd.js","assets/vue-router-70e2faff.js","assets/@vueuse-ca9a384d.js","assets/tiny-emitter-35dc7566.js","assets/echarts-24943dbb.js","assets/zrender-2d3b2bba.js","assets/tslib-a4e99503.js","assets/xgplayer-700bd6a3.js","assets/delegate-ef66b241.js","assets/downloadjs-91c0ea73.js","assets/quill-ecb3881d.js","assets/quill-8e59e50e.css","assets/sortablejs-2f5483e3.js","assets/index-29e4a384.css"]))),N=M((()=>e((()=>import("./TableOptional-90ece1ed.js")),["assets/TableOptional-90ece1ed.js","assets/@arco-design-8dabd30f.js","assets/@vue-2b41ce19.js","assets/b-tween-5055d79e.js","assets/b-validate-457088db.js","assets/resize-observer-polyfill-ad543aa3.js","assets/scroll-into-view-if-needed-59a60a09.js","assets/compute-scroll-into-view-2962e95c.js","assets/number-precision-d9b928a1.js","assets/dayjs-094145ee.js","assets/@logicflow-85f8458e.js","assets/ids-ef071351.js","assets/lodash-es-1e3e3aa2.js","assets/preact-5fc9b0bf.js","assets/@logicflow-4fbf093d.css","assets/@arco-design-766c8d5e.css"]))),{ADD:K,UPDATE:ue}=c,de=t(),ye=_("plan"),ve=_(1),me=_({id:void 0,insepctPalnTaskName:void 0,inspectCustomDate:void 0,inspectPlanCreator:void 0,inspectPlanDescrible:void 0,inspectPlanDomain:void 0,inspectPlanInspector:void 0,inspectPlanLastEditTime:void 0,inspectPlanLastExecTime:void 0,inspectPlanReportModifiorShow:void 0,inspectPlanReportModifyTimeShow:void 0,inspectPlanReportProduceTimeShow:void 0,inspectPlanStatus:void 0,inspectPlanType:void 0,inspectPlanTypeTime:void 0,inspectReportBusinessName:void 0,inspectReportResourceName:void 0,inspectRlanReportEditable:void 0,inspectTypeCustomDate:void 0,inspectTypeCustomHour:void 0,inspectTypeCustomMinute:void 0,inspectTypeCustomMonth:void 0,inspectTypeCustomYear:void 0,inspectTypeDate:void 0,inspectTypeFirstMonth:void 0,inspectTypeFriday:void 0,inspectTypeHour:void 0,inspectTypeMinute:void 0,inspectTypeMonday:void 0,inspectTypeMonth:void 0,inspectTypeMonthDate:void 0,inspectTypeMonthHour:void 0,inspectTypeMonthMinute:void 0,inspectTypeSaturday:void 0,inspectTypeSecondMonth:void 0,inspectTypeSunday:void 0,inspectTypeThirdMonth:void 0,inspectTypeThursday:void 0,inspectTypeTuesday:void 0,inspectTypeWednesday:void 0});function Te(){Object.keys(me.value).forEach((e=>{me.value[e]=void 0})),ve.value=1}const fe=_([]),he=_(),je=_();w("userOptions",fe),w("item",{contentList:he,resultList:je,form:me});const be=_(!1),ge=_(null),Ce=W(Le),Me=q(),{bordered:_e,striped:we,handleSuccess:ke,tableLoading:De,dataList:Se}=Me,Pe=Z("id"),{onSorterChange:xe,sortOrder:Ee}=J(Le),{plan:He,report:Re}=X(),Oe=k((()=>"report"===ye.value?Re:He));async function Le(){De.value=!0;const e={pageNum:Ce.page,pageSize:Ce.pageSize,orderByColumn:Ee.orderBy,isAsc:Ee.isAsc,...a(Oe.value)};try{const{code:t,rows:a,msg:s,total:i}="report"===ye.value?await G(e):await Q(e),o={code:t,msg:s,data:a};De.value=!1,ke(B(o)),Ce.setTotalSize(i||10)}catch(t){}}function Ve(){Oe.value.forEach((e=>{e.searchReset?e.searchReset():e.searchValue=void 0})),Le()}function Ie(e){const t={planId:e.id};t?y.confirm({title:"提示",content:`确定要${e?"删除此":"删除所选择的"}数据吗？`,cancelText:"取消",okText:"删除",onOk:async()=>{try{const{msg:e}=await ee(t);d.success(e),Le()}catch(e){}}}):d.error("请选择要删除的数据")}async function Ye(e){const t=e.id;try{const{msg:e}=await te({planId:t});d.success(e),Le()}catch(a){}}function Fe(e){var t;!async function(e){try{const{data:t}=await ie({planId:e});for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&Object.prototype.hasOwnProperty.call(me.value,e)&&(me.value[e]=t[e])}catch(t){}}(e.id),async function(e){try{const{data:t}=await oe({planId:e});he.value=t.contentList,je.value=t.resultList}catch(t){}}(e.id),de.title=ue,null==(t=ge.value)||t.show(),Te()}function Ue(){var e;de.title=K,null==(e=ge.value)||e.show(),Te()}function Ae(e,t){}function ze(){ve.value=Math.max(1,ve.value-1)}async function Be(){be.value=!0;const e={inspectTypeHour:void 0,inspectTypeMinute:void 0,inspectCustomDate:void 0,inspectTypeMonday:void 0,inspectTypeTuesday:void 0,inspectTypeWednesday:void 0,inspectTypeThursday:void 0,inspectTypeFriday:void 0,inspectTypeSaturday:void 0,inspectTypeSunday:void 0};switch(me.value.inspectPlanType){case 2:e.inspectTypeHour=me.value.inspectTypeHour,e.inspectTypeMinute=me.value.inspectTypeMinute;break;case 3:e.inspectTypeMonday=me.value.inspectTypeMonday,e.inspectTypeTuesday=me.value.inspectTypeTuesday,e.inspectTypeWednesday=me.value.inspectTypeWednesday,e.inspectTypeThursday=me.value.inspectTypeThursday,e.inspectTypeFriday=me.value.inspectTypeFriday,e.inspectTypeSaturday=me.value.inspectTypeSaturday,e.inspectTypeSunday=me.value.inspectTypeSunday,e.inspectTypeHour=me.value.inspectTypeHour,e.inspectTypeMinute=me.value.inspectTypeMinute;break;case 4:e.inspectTypeDate=me.value.inspectTypeDate,e.inspectTypeHour=me.value.inspectTypeHour,e.inspectTypeMinute=me.value.inspectTypeMinute;break;case 5:e.inspectCustomDate=me.value.inspectCustomDate,e.inspectTypeHour=me.value.inspectTypeHour,e.inspectTypeMinute=me.value.inspectTypeMinute}try{const{data:t}=await se({...me.value,...e});ve.value=Math.min(3,ve.value+1),me.value.id=t}catch(t){}finally{be.value=!1}}function Ne({values:e,errors:t}){}const Ke=_(!1);function We(){Ke.value=!0,setTimeout((()=>{var e;Ke.value=!1,null==(e=ge.value)||e.close()}),600)}const{inspectionCycleOptions:qe}=pe();function Je(){var e;be.value=!1,null==(e=ge.value)||e.close(),Le()}return D((()=>{!async function(){try{const{rows:e}=await ne({isPage:!1});fe.value=e.map((e=>({label:e.userName,value:e.userId})))}catch(e){}}(),Le()})),(e,t)=>{const a=v,c=m,u=T,y=s,M=i,_=o,w=f,k=h,D=j,B=n,K=p,W=l,q=S("icon-left"),J=S("icon-right"),X=b,Z=g,G=r;return P(),x(z,null,[E("div",le,[H(W,{ref:"tableBody"},{header:R((()=>[H(_,{"show-filter":!0,title:"",onSearch:Le,onResetSearch:Ve},O({"card-left":R((()=>[H(c,{type:"rounded","active-key":ye.value,"onUpdate:activeKey":t[0]||(t[0]=e=>ye.value=e),"default-active-key":"plan","hide-content":"",animation:"",onTabClick:Le},{default:R((()=>[H(a,{key:"plan",title:"巡检计划"}),H(a,{key:"report",title:"巡检报告"})])),_:1},8,["active-key"])])),"search-content":R((()=>[H(y,{modelValue:Oe.value,"onUpdate:modelValue":t[1]||(t[1]=e=>Oe.value=e)},null,8,["modelValue"])])),"table-config":R((()=>[H(M,{tableColumns:Oe.value,"onUpdate:border":t[2]||(t[2]=e=>L(Me).bordered.value=e),"onUpdate:striped":t[3]||(t[3]=e=>L(Me).striped.value=e),onDoRefresh:Le},null,8,["tableColumns"])])),_:2},["plan"===ye.value?{name:"more-button-content",fn:R((()=>[H(u,{type:"primary",onClick:Ue},{default:R((()=>[V(" 添加 ")])),_:1})])),key:"0"}:void 0]),1024)])),default:R((()=>[H(B,{bordered:L(_e),striped:L(we),tableLoading:L(De),dataList:L(Se),tableColumns:Oe.value,rowKey:L(Pe),onSorterChange:L(xe),onFilterChange:Ae},{optional:R((({record:e})=>[H(L(N),{record:e,tabsActive:ye.value,onOnDeleteItems:Ie,onOnCopy:Ye},null,8,["record","tabsActive"])])),task:R((({record:e})=>[H(w,{content:"编辑",position:"top",mini:""},{default:R((()=>[H(u,{type:"text",onClick:t=>Fe(e)},{default:R((()=>[V(I(e.task),1)])),_:2},1032,["onClick"])])),_:2},1024)])),type:R((({record:e})=>{return[V(I((t=e,(null==(a=qe.find((e=>e.value===t.type)))?void 0:a.label)||"")),1)];var t,a})),status:R((({record:e})=>[H(k,{modelValue:e.status,"onUpdate:modelValue":t=>e.status=t,"checked-value":!0,"unchecked-value":!1,beforeChange:t=>(async(e,t)=>{try{const a=await ae({planId:t.id,status:e});return d.success(a.msg),!0}catch(a){return!1}})(t,e)},{checked:R((()=>[V(" 启用 ")])),unchecked:R((()=>[V(" 停用 ")])),_:2},1032,["modelValue","onUpdate:modelValue","beforeChange"])])),lastEditTime:R((({record:e})=>[V(I(e.lastEditTime?L($)(e.lastEditTime).format("YYYY-MM-DD HH:mm:ss"):void 0),1)])),lastExecTime:R((({record:e})=>[V(I(e.lastExecTime?L($)(e.lastExecTime).format("YYYY-MM-DD HH:mm:ss"):void 0),1)])),inspectReportStatus:R((({record:e})=>[e.inspectReportStatus?(P(),Y(D,{key:0},{default:R((()=>[V("未提交")])),_:1})):(P(),Y(D,{key:1,color:"green"},{default:R((()=>[V("已提交")])),_:1}))])),_:1},8,["bordered","striped","tableLoading","dataList","tableColumns","rowKey","onSorterChange"])])),footer:R((()=>[H(K,{pagination:L(Ce)},null,8,["pagination"])])),_:1},512)]),H(G,{ref_key:"modalDialog",ref:ge,config:L(de),onCancel:Je},{content:R((()=>[H(Z,{model:me.value,onSubmit:Ne},{default:R((()=>[H(L(C),{modelValue:me.value,"onUpdate:modelValue":t[4]||(t[4]=e=>me.value=e),current:ve.value,"onUpdate:cycleForm":Be},null,8,["modelValue","current"]),E("div",re,[H(X,null,{default:R((()=>[F(H(u,{type:"primary",onClick:ze},{default:R((()=>[H(q),V(" 上一步 ")])),_:1},512),[[U,2===ve.value]]),F(H(u,{loading:be.value,type:"primary","html-type":"submit",onClick:Be},{default:R((()=>[V(" 下一步 "),H(J)])),_:1},8,["loading"]),[[U,1===ve.value]]),F(H(u,{type:"primary","html-type":"submit"},{default:R((()=>[V(" 保存 ")])),_:1},512),[[U,1===ve.value]]),F(H(u,{type:"primary",loading:Ke.value,onClick:A(We,["stop"])},{default:R((()=>[V("完成")])),_:1},8,["loading","onClick"]),[[U,2===ve.value]])])),_:1})])])),_:1},8,["model"])])),footer:R((()=>[ce])),_:1},8,["config"])],64)}}}),[["__scopeId","data-v-485597bf"]]);export{ue as default};
