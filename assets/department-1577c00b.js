import{n as G,_ as K}from"./index-09e9d0bf.js";import{b as N,c as P,d as S}from"./table-d5bdf2e1.js";import{p as j}from"./http-79937b7b.js";import{h as q,M as V}from"./@arco-design-f5decd74.js";import{l as h}from"./lodash-es-734afc83.js";import{e as H,a as z,r as k,o as J,j as l,k as f,p as I,v as o,m as a,F as A,R as L,l as w,G as Q,y as p,z as T}from"./@vue-0366cb61.js";import"./path-browserify-188d1ff8.js";import"./vue-router-5bfb708a.js";import"./axios-0bf28a1e.js";import"./@logicflow-5cdfeb8e.js";import"./ids-46106237.js";import"./preact-b8060ab3.js";import"./qs-b99d1803.js";import"./side-channel-5f245a46.js";import"./get-intrinsic-b9397c9a.js";import"./has-symbols-e8f3ca0e.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-9ceb8f5b.js";import"./object-inspect-8530d459.js";import"./pinia-16e4d8ec.js";import"./@vueuse-945dd224.js";import"./mockjs-417a16d8.js";import"./tiny-emitter-6d407e5e.js";import"./xgplayer-cee6bcaa.js";import"./quill-9354d83a.js";import"./sortablejs-be94e56d.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./compute-scroll-into-view-183f845a.js";import"./b-tween-aacd5abe.js";import"./dayjs-bf5be20d.js";import"./b-validate-48f29bf6.js";import"./number-precision-7e656275.js";import"./scroll-into-view-if-needed-6b992d05.js";function W(){return j}const X="dp_code_",Y=H({name:"Department",setup(){const e=N(),r=P([{title:"部门名称",key:"name",dataIndex:"name"},{title:"部门编号",key:"depCode",dataIndex:"depCode"},{title:"排序",key:"order",dataIndex:"order"},{title:"状态",key:"status",dataIndex:"status"},{title:"操作",key:"actions",dataIndex:"actions"}]),s=z({parentId:void 0,id:0,name:"",depCode:"",order:1,status:1}),b=k(),c=k(),B=S("id"),i=k(null),E=W();function _(){E({url:G}).then(({data:n=[]})=>(e.tableLoading.value=!1,e.dataList.length=0,e.dataList.push(...n),n))}function g(n,d){for(let u=0;u<n.length;u++){const m=n[u];if(m.id===d.id){if(!h.isEmpty(m.children)){V.error("当前部门下有子部门，不能删除");return}n.splice(u,1);return}else h.isEmpty(m.children)||g(m.children,d)}}const F=n=>{q.confirm({title:"提示",content:"确定要删除此信息，删除后不可恢复？",onOk(){g(e.dataList,n)}})};function v(){var n;c.value="添加部门",s.parentId=void 0,s.id=0,s.status=1,s.depCode="",s.name="",s.order=1,(n=i.value)==null||n.toggle()}function y(){var n;(n=b.value)==null||n.validate().then(d=>{var u;d||((u=i.value)==null||u.close(),V.success("模拟部门添加/编辑成功，数据为："+JSON.stringify(s)))}).catch(d=>{console.log("error",d)})}function C(n){var d;c.value="编辑部门",Object.keys(n).forEach(u=>{s[u]=n[u]}),s.parentId=n.parentId,(d=i.value)==null||d.toggle()}return J(_),{DP_CODE_FLAG:X,formRef:b,dialogTitle:c,departmentModel:s,...e,rowKey:B,tableColumns:r,onUpdateItem:C,onDataFormConfirm:y,onDeleteItem:F,onAddItem:v,modalDialog:i}}});const Z={class:"main-container"};function x(e,r,s,b,c,B){const i=l("AddButton"),E=l("TableHeader"),_=l("a-button"),g=l("a-space"),F=l("a-table-column"),v=l("a-table"),y=l("TableBody"),C=l("a-option"),n=l("a-select"),d=l("a-form-item"),u=l("a-input"),m=l("a-input-number"),D=l("a-radio"),U=l("a-radio-group"),$=l("a-form"),O=l("ModalDialog");return f(),I("div",Z,[o(y,null,{header:a(()=>[o(E,{"show-filter":!1},{"table-config":a(()=>[o(i,{onAdd:e.onAddItem},null,8,["onAdd"])]),_:1})]),default:a(()=>[o(v,{bordered:!1,loading:e.tableLoading,data:e.dataList,"row-key":e.rowKey,pagination:!1},{columns:a(()=>[(f(!0),I(A,null,L(e.tableColumns,t=>(f(),w(F,{key:t.key,align:t.align,title:t.title,width:t.width,"data-index":t.key,fixed:t.fixed},Q({_:2},[t.key==="actions"?{name:"cell",fn:a(({record:M})=>[o(g,null,{default:a(()=>[o(_,{status:"success",onClick:R=>e.onUpdateItem(M)},{default:a(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),o(_,{status:"danger",onClick:R=>e.onDeleteItem(M)},{default:a(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),key:"0"}:void 0]),1032,["align","title","width","data-index","fixed"]))),128))]),_:1},8,["loading","data","row-key"])]),_:1}),o(O,{ref:"modalDialog",title:e.dialogTitle,onConfirm:e.onDataFormConfirm},{content:a(()=>[o($,{ref:"formRef",model:e.departmentModel,labelCol:{span:4}},{default:a(()=>[o(d,{label:"上级部门",name:"parentId"},{default:a(()=>[o(n,{modelValue:e.departmentModel.parentId,"onUpdate:modelValue":r[0]||(r[0]=t=>e.departmentModel.parentId=t),placeholder:"请选择上级部门"},{default:a(()=>[(f(!0),I(A,null,L(e.dataList,t=>(f(),w(C,{key:t.id,value:t.id},{default:a(()=>[p(T(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"部门名称",field:"name",rules:[{required:!0,message:"请输入部门名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}],"validate-trigger":["change","input"]},{default:a(()=>[o(u,{placeholder:"请输入部门名称",modelValue:e.departmentModel.name,"onUpdate:modelValue":r[1]||(r[1]=t=>e.departmentModel.name=t)},null,8,["modelValue"])]),_:1}),o(d,{label:"部门编号",field:"depCode",rules:[{required:!0,message:"请输入部门编号"},{min:3,max:10,message:"长度在 3 - 30个字符"}],"validate-trigger":["change","input"]},{default:a(()=>[o(u,{placeholder:"请输入部门编号",modelValue:e.departmentModel.depCode,"onUpdate:modelValue":r[2]||(r[2]=t=>e.departmentModel.depCode=t)},{prepend:a(()=>[p(T(e.DP_CODE_FLAG),1)]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"排序",name:"order"},{default:a(()=>[o(m,{modelValue:e.departmentModel.order,"onUpdate:modelValue":r[3]||(r[3]=t=>e.departmentModel.order=t)},null,8,["modelValue"])]),_:1}),o(d,{label:"状态",name:"status"},{default:a(()=>[o(U,{modelValue:e.departmentModel.status,"onUpdate:modelValue":r[4]||(r[4]=t=>e.departmentModel.status=t)},{default:a(()=>[o(D,{value:1},{default:a(()=>[p("正常")]),_:1}),o(D,{value:0},{default:a(()=>[p("禁用")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","onConfirm"])])}const Ue=K(Y,[["render",x],["__scopeId","data-v-b1e28bba"]]);export{Ue as default};
