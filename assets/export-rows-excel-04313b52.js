import{p as I}from"./http-79937b7b.js";import{g as L,_ as R}from"./index-09e9d0bf.js";import{b as S,a as T,c as v,d as E}from"./table-d5bdf2e1.js";import{X as _}from"./xlsx-09ff2a58.js";import{M as B}from"./@arco-design-f5decd74.js";import{e as K,r as F,o as N,j as r,k as l,p as h,v as i,m as e,y as c,F as $,R as M,l as g,G as X,z as C}from"./@vue-0366cb61.js";import"./path-browserify-188d1ff8.js";import"./vue-router-5bfb708a.js";import"./axios-0bf28a1e.js";import"./@logicflow-5cdfeb8e.js";import"./ids-46106237.js";import"./preact-b8060ab3.js";import"./qs-b99d1803.js";import"./side-channel-5f245a46.js";import"./get-intrinsic-b9397c9a.js";import"./has-symbols-e8f3ca0e.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-9ceb8f5b.js";import"./object-inspect-8530d459.js";import"./pinia-16e4d8ec.js";import"./@vueuse-945dd224.js";import"./mockjs-417a16d8.js";import"./tiny-emitter-6d407e5e.js";import"./xgplayer-cee6bcaa.js";import"./quill-9354d83a.js";import"./sortablejs-be94e56d.js";import"./lodash-es-734afc83.js";import"./resize-observer-polyfill-0f9f8adb.js";import"./compute-scroll-into-view-183f845a.js";import"./b-tween-aacd5abe.js";import"./dayjs-bf5be20d.js";import"./b-validate-48f29bf6.js";import"./number-precision-7e656275.js";import"./scroll-into-view-if-needed-6b992d05.js";const z=K({name:"ExportRowsExcel",setup(){const o=F(null),s=S(),{selectedRowKeys:p,onSelectionChange:b}=T(),x=E("id"),w=v([s.indexColumn,{title:"名称",key:"nickName",dataIndex:"nickName"},{title:"性别",key:"gender",dataIndex:"gender"},{title:"地址",key:"address",dataIndex:"address"},{title:"登录时间",key:"lastLoginTime",dataIndex:"lastLoginTime"},{title:"登录IP",key:"lastLoginIp",dataIndex:"lastLoginIp"},{title:"状态",key:"status",dataIndex:"status"}]);function k(){I({url:L,data:{page:1,pageSize:20}}).then(s.handleSuccess).catch(console.log)}function f(){if(p.value.length===0){B.error("请选择要导出的行");return}const m=p.value.map(t=>s.dataList.find(y=>y.id===t)).map(t=>[t.nickName,t.gender===0?"男":"女",t.address,t.lastLoginTime,t.lastLoginIp]);m.unshift(["昵称","性别","地址","上次登录时间","上次登录IP"]);const d=_.utils.aoa_to_sheet(m),u=_.utils.book_new();_.utils.book_append_sheet(u,d,"数据报表"),_.writeFile(u,"table-list.xlsx")}return N(k),{tableRef:o,...s,selectedRowKeys:p,onSelectionChange:b,tableColumns:w,rowKey:x,exportExcel:f}}}),D={class:"main-container"};function H(o,s,p,b,x,w){const k=r("a-button"),f=r("TableHeader"),m=r("a-avatar"),d=r("a-tag"),u=r("a-table-column"),t=r("a-table"),y=r("TableBody");return l(),h("div",D,[i(f,{"show-filter":!1},{"table-config":e(()=>[i(k,{type:"primary",onClick:o.exportExcel},{default:e(()=>[c("导出选中的Excel ")]),_:1},8,["onClick"])]),_:1}),i(y,null,{default:e(()=>[i(t,{ref:"tableRef",data:o.dataList,pagination:!1,"row-key":o.rowKey,"row-selection":{selectedRowKeys:o.selectedRowKeys},onSelectionChange:o.onSelectionChange},{columns:e(()=>[(l(!0),h($,null,M(o.tableColumns,a=>(l(),g(u,{key:a.key,align:"center",title:a.title,"data-index":a.key},X({_:2},[a.key==="index"?{name:"cell",fn:e(({rowIndex:n})=>[c(C(n+1),1)]),key:"0"}:a.key==="gender"?{name:"cell",fn:e(({record:n})=>[c(C(n.gender===1?"男":"女"),1)]),key:"1"}:a.key==="avatar"?{name:"cell",fn:e(({record:n})=>[i(m,{src:n.avatar},null,8,["src"])]),key:"2"}:a.key==="status"?{name:"cell",fn:e(({record:n})=>[n.status===1?(l(),g(d,{key:0,color:"blue"},{default:e(()=>[c("正常")]),_:1})):(l(),g(d,{key:1,color:"red"},{default:e(()=>[c("禁用")]),_:1}))]),key:"3"}:void 0]),1032,["title","data-index"]))),128))]),_:1},8,["data","row-key","row-selection","onSelectionChange"])]),_:1})])}const he=R(z,[["render",H]]);export{he as default};
