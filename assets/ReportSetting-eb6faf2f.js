import{M as e,Q as t,i,B as l,x as a,V as s,s as o,Z as d,aw as n,R as u,ax as r,ay as c,ap as m,az as p}from"./@arco-design-8dabd30f.js";import{d as v,u as f,i as y,b as h,l as j,o as b,m as x,w as I,s as _,f as k,c as C,F as w,R as g,C as V,D,K as U,q as R,J as z,N as A,O as N}from"./@vue-2b41ce19.js";import{u as P}from"./dict-9c237ae6.js";import{I as q,J as B}from"./index-0ca45986.js";import{a as L,b as J}from"./index-55fae50f.js";import"./b-tween-5055d79e.js";import"./b-validate-457088db.js";import"./resize-observer-polyfill-ad543aa3.js";import"./scroll-into-view-if-needed-59a60a09.js";import"./compute-scroll-into-view-2962e95c.js";import"./number-precision-d9b928a1.js";import"./dayjs-094145ee.js";import"./@logicflow-85f8458e.js";import"./ids-ef071351.js";import"./lodash-es-1e3e3aa2.js";import"./preact-5fc9b0bf.js";import"./pinia-b3c1485e.js";import"./axios-6371c10e.js";import"./qs-f981fe00.js";import"./side-channel-01aeb4d9.js";import"./get-intrinsic-bac01933.js";import"./has-symbols-456daba2.js";import"./has-proto-4a87f140.js";import"./function-bind-72d06d3b.js";import"./has-885c3436.js";import"./call-bind-fae29077.js";import"./object-inspect-0eda087e.js";import"./path-browserify-8c7c24dd.js";import"./vue-router-70e2faff.js";import"./@vueuse-ca9a384d.js";import"./tiny-emitter-35dc7566.js";import"./echarts-24943dbb.js";import"./zrender-2d3b2bba.js";import"./tslib-a4e99503.js";import"./xgplayer-700bd6a3.js";import"./delegate-ef66b241.js";import"./downloadjs-91c0ea73.js";import"./quill-ecb3881d.js";import"./sortablejs-2f5483e3.js";const M=k("div",{class:"w-full flex justify-start items-center"}," 常规信息 ",-1),O={class:"w-full flex justify-between items-center"},S=k("div",null,"巡检章节设置",-1),F={key:0,class:"flex items-center"},K={class:"text-xs"},T={key:1,class:"flex"},$={class:"w-6"},E={class:"w-6"},H={class:"w-full flex justify-between items-center"},Q={class:"flex items-center"},Z={class:"text-xs"},G={class:"w-full flex justify-between"},W={class:"flex justify-between"},X={class:"w-10"},Y={class:"mt-2"},ee=v({__name:"ReportSetting",setup(v){const{inspectionPlanChildrenColumns:ee}=P(),te=f(q(ee).filter((e=>"optional"!==e.dataIndex))),ie=f(te.value.filter((e=>e.slotName))),le=y("item"),ae=f(le.contentList),se=f(le.form),oe=f(le.resultList),de=[{label:"巡检报告名称",value:"网络设备巡检"},{label:"巡检时间",value:" "},{label:"巡检人",value:"admin"}];function ne(){me.value>=5||oe.value.push({summeriseName:"",sumeriseDescrible:"",uuid:B()})}let ue=null;const re=async e=>{clearTimeout(ue),ue=setTimeout((async()=>{var t;let i={};i=Array.isArray(e)?{basicId:se.value.id,list:e.map((e=>({childItme:e.childItme,id:e.id||void 0,itmeDescrible:e.itmeDescrible}))),resultList:oe.value}:{basicId:se.value.id,list:null==(t=e.children)?void 0:t.map((e=>({childItme:e.childItme,id:e.id||void 0,itmeDescrible:e.itmeDescrible}))),parentId:e.id,resultList:oe.value};try{const{data:t}=await J(i);Array.isArray(e)?e=t:e.children=t}catch(l){}}),300)};function ce(e){e.children||(e.children=[]),e.children.push({id:void 0,inspectPlanId:void 0,parentId:e.id,childItme:"",itmeDescrible:"",itmeValue:void 0,itmeReferencePrefix:void 0,itmeReferenceSubfix:void 0,itmeUnit:void 0,itmeConditionDescrible:void 0,sort:0,edit:!0,indicatorAsItme:!1,resourceId:void 0,indexModelId:void 0,modelId:void 0,type:void 0,children:void 0,uuid:B()})}const me=h((()=>oe.value.length));function pe(){ae.value.push({id:void 0,inspectPlanId:void 0,parentId:void 0,childItme:"",itmeDescrible:"",itmeValue:void 0,itmeReferencePrefix:void 0,itmeReferenceSubfix:void 0,itmeUnit:void 0,itmeConditionDescrible:void 0,sort:0,edit:!0,indicatorAsItme:!1,resourceId:void 0,indexModelId:void 0,modelId:void 0,type:void 0,children:void 0,uuid:B()})}return(v,f)=>{const y=t,h=i,P=j("icon-plus"),B=l,J=a,le=s,ue=o,ve=d,fe=j("icon-user-add"),ye=j("icon-delete"),he=j("icon-check"),je=j("icon-close"),be=j("icon-edit"),xe=n,Ie=u,_e=r,ke=c,Ce=m,we=p;return b(),x(ve,{direction:"vertical",fill:"",class:"pb-[52px]"},{default:I((()=>[_(h,{title:"常规信息",id:"test123"},{title:I((()=>[M])),default:I((()=>[_(y,{data:de,bordered:""})])),_:1}),_(h,{title:"巡检章节设置"},{title:I((()=>[k("div",O,[S,_(J,{content:"添加一条巡检章节",mini:""},{default:I((()=>[_(B,{type:"text",onClick:pe},{default:I((()=>[_(P)])),_:1})])),_:1})])])),default:I((()=>[_(ke,{"default-active-key":[0],"destroy-on-hide":"",bordered:""},{default:I((()=>[(b(!0),C(w,null,g(ae.value,((t,i)=>(b(),x(_e,{key:i},{header:I((()=>[_(ve,null,{default:I((()=>[t.edit?(b(),C("div",T,[_(ve,null,{default:I((()=>[_(le,{modelValue:t.childItme,"onUpdate:modelValue":e=>t.childItme=e,type:"text",onClick:f[0]||(f[0]=U((()=>{}),["stop"])),onChange:f[1]||(f[1]=e=>re(ae.value))},null,8,["modelValue","onUpdate:modelValue"]),_(ue,{direction:"vertical"}),_(le,{modelValue:t.itmeDescrible,"onUpdate:modelValue":e=>t.itmeDescrible=e,type:"text",onClick:f[2]||(f[2]=U((()=>{}),["stop"])),onChange:f[3]||(f[3]=e=>re(ae.value))},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])):(b(),C("div",F,[V(D(t.childItme)+"-",1),k("div",K,D(t.itmeDescrible),1)]))])),_:2},1024)])),extra:I((()=>[_(ve,{align:"start"},{default:I((()=>[t.edit?(b(),C(w,{key:0},[_(J,{content:"添加手动巡检项",mini:""},{default:I((()=>[_(B,{onClick:U((e=>ce(t)),["stop"]),type:"text"},{default:I((()=>[_(fe)])),_:2},1032,["onClick"])])),_:2},1024),_(J,{content:"添加系统关联巡检项",mini:""},{default:I((()=>[_(B,{onClick:f[4]||(f[4]=U((()=>{}),["stop"])),type:"text"},{default:I((()=>[_(P)])),_:1})])),_:1}),_(J,{content:"删除",mini:""},{default:I((()=>[_(B,{onClick:[f[5]||(f[5]=U((()=>{}),["stop"])),i=>async function(t){if(t.id)try{ae.value=ae.value.filter((e=>e.id!==t.id));const i={delId:t.id,planId:se.value.id},{msg:l}=await L(i);e.success(l)}catch(i){}else ae.value=ae.value.filter((e=>e.uuid!==t.uuid));re(ae.value)}(t)],status:"danger",type:"text"},{default:I((()=>[_(ye)])),_:2},1032,["onClick"])])),_:2},1024),_(J,{onClick:f[6]||(f[6]=U((()=>{}),["stop"])),content:"保存",mini:""},{default:I((()=>[_(B,{type:"text",status:"success",onClick:U((e=>function(e){try{re(e),e.edit=!1}catch(t){}}(t)),["stop"])},{default:I((()=>[_(he)])),_:2},1032,["onClick"])])),_:2},1024)],64)):R("",!0),_(J,{onClick:f[7]||(f[7]=U((()=>{}),["stop"])),content:t.edit?"取消编辑":"编辑巡检项",mini:""},{default:I((()=>[_(B,{type:"text",onClick:U((e=>function(e){e.edit=!e.edit,e.edit?te.value=q(ee):te.value=te.value.filter((e=>"optional"!==e.dataIndex))}(t)),["stop"])},{default:I((()=>[t.edit?(b(),x(je,{key:0})):(b(),x(be,{key:1}))])),_:2},1032,["onClick"])])),_:2},1032,["content"])])),_:2},1024)])),default:I((()=>[_(Ie,{"column-resizable":"",bordered:"",tooltip:"",ellipsis:!0,pagination:!1,data:t.children,columns:te.value,rowKey:"id"},z({optional:I((({record:t})=>[_(ve,{align:"end"},{default:I((()=>[k("div",$,[A(_(B,{type:"text",onClick:e=>ce(t)},{default:I((()=>[_(P)])),_:2},1032,["onClick"]),[[N,!t.id&&t.parentId]])]),k("div",E,[_(xe,{content:`是否确认删除所选巡检项：${t.childItme}?`,onOk:i=>async function(t){const i=t.id,l=t.uuid,a=(e,t)=>{for(let i=0;i<e.length;i++){const l=e[i];if(l.id===t||l.uuid===t)return e.splice(i,1),!0;if(l.children&&a(l.children,t))return!0}return!1};if(i)try{const t={delId:i,planId:se.value.id},{msg:l}=await L(t);e.success(l),a(ae.value,i)}catch(s){}else l&&a(ae.value,l)}(t)},{default:I((()=>[_(J,{content:"删除巡检项"},{default:I((()=>[_(B,{type:"text",onClick:f[8]||(f[8]=U((()=>{}),["stop"]))},{default:I((()=>[_(ye)])),_:1})])),_:1})])),_:2},1032,["content","onOk"])])])),_:2},1024)])),_:2},[g(ie.value,(({slotName:e})=>({name:e,fn:I((({record:i})=>[t.edit?(b(),x(le,{key:0,onBlur:e=>function(e){e.edit=!e.edit}(i),modelValue:i[e],"onUpdate:modelValue":t=>i[e]=t,onChange:e=>re(t)},null,8,["onBlur","modelValue","onUpdate:modelValue","onChange"])):(b(),C(w,{key:1},[V(D(i[e]),1)],64))]))})))]),1032,["data","columns"])])),_:2},1024)))),128))])),_:1})])),_:1}),_(h,{title:"结论"},{title:I((()=>[k("div",H,[k("div",Q,[V(" 结论-"),k("div",Z," 最多支持添加5个子结论/已添加"+D(oe.value.length||0)+"个 ",1)]),k("div",null,[_(J,{content:`新增巡检结论(最多5个,已存在${oe.value.length}个)`},{default:I((()=>[_(B,{type:"primary",onClick:ne},{default:I((()=>[_(P)])),_:1})])),_:1},8,["content"])])])])),default:I((()=>[(b(!0),C(w,null,g(oe.value,((t,i)=>(b(),C(w,{key:i},[_(we,null,{author:I((()=>[k("div",G,[k("div",W,[_(le,{modelValue:t.summeriseName,"onUpdate:modelValue":e=>t.summeriseName=e,type:"text",onChange:f[9]||(f[9]=e=>re(ae.value))},{prepend:I((()=>[V(D(i+1)+"、 ",1)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),A(k("div",X,[_(J,{content:"删除巡检结论",mini:""},{default:I((()=>[_(B,{type:"text",onClick:i=>async function(t){if(t.id)try{oe.value=oe.value.filter((e=>e.id!==t.id));const i={delId:t.id,planId:se.value.id},{msg:l}=await L(i);e.success(l)}catch(i){}else{if(1===me.value)return;oe.value=oe.value.filter((e=>e.uuid!==t.uuid))}}(t)},{default:I((()=>[_(ye)])),_:2},1032,["onClick"])])),_:2},1024)],512),[[N,i>=1]])])])),content:I((()=>[k("div",Y,[_(Ce,{"auto-size":{minRows:3,maxRows:6},modelValue:t.sumeriseDescrible,"onUpdate:modelValue":e=>t.sumeriseDescrible=e,onChange:f[10]||(f[10]=e=>re(ae.value))},null,8,["modelValue","onUpdate:modelValue"])])])),_:2},1024),_(ue)],64)))),128))])),_:1})])),_:1})}}});export{ee as default};
